<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.527">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="신록예찬">
<meta name="dcterms.date" content="2022-12-24">

<title>Seoyeon’s Blog - [CGSP] Chap 8.3: Discrete Fourier Transform</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Seoyeon’s Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://seoyeonc.github.io/md/"> 
<span class="menu-text">Lectures_ing</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://seoyeonc.github.io/chch/"> 
<span class="menu-text">Lectures_fastai</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://seoyeonc.github.io/Research_area/"> 
<span class="menu-text">Research_ing</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://seoyeonc.github.io/ms/"> 
<span class="menu-text">Research_fastai</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://seoyeonc.github.io/GODE_blog/"> 
<span class="menu-text">GODE</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://seoyeonc.github.io/HCAM_blog/"> 
<span class="menu-text">HCAM</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://seoyeonc.github.io/ITTGNN_blog/"> 
<span class="menu-text">ITTGNN</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://seoyeonc.github.io/julia/"> 
<span class="menu-text">Julia</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/seoyeonc"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><strong>[CGSP]</strong> Chap 8.3: Discrete Fourier Transform</li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title"><strong>[CGSP]</strong> Chap 8.3: Discrete Fourier Transform</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>신록예찬 </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">December 24, 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../1_note.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Note</strong></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text"><strong>Studies</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2_graph.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Graph</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2_ept.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EPT</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2_stgcn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">STGCN</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2_linearalgebra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Algebra</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#discrete-fourier-transform" id="toc-discrete-fourier-transform" class="nav-link active" data-scroll-target="#discrete-fourier-transform">Discrete Fourier Transform</a>
  <ul class="collapse">
  <li><a href="#cyclic-shfit-operator-bf-b" id="toc-cyclic-shfit-operator-bf-b" class="nav-link" data-scroll-target="#cyclic-shfit-operator-bf-b">Cyclic shfit operator <span class="math inline">\({\bf B}\)</span></a></li>
  <li><a href="#dft" id="toc-dft" class="nav-link" data-scroll-target="#dft">DFT</a></li>
  <li><a href="#spectral-components-and-frequencies" id="toc-spectral-components-and-frequencies" class="nav-link" data-scroll-target="#spectral-components-and-frequencies">Spectral components and Frequencies</a></li>
  </ul></li>
  <li><a href="#내-마음대로-summary" id="toc-내-마음대로-summary" class="nav-link" data-scroll-target="#내-마음대로-summary">내 마음대로 Summary</a>
  <ul class="collapse">
  <li><a href="#dft-1" id="toc-dft-1" class="nav-link" data-scroll-target="#dft-1">DFT</a></li>
  <li><a href="#inverse-dft" id="toc-inverse-dft" class="nav-link" data-scroll-target="#inverse-dft">Inverse DFT</a></li>
  <li><a href="#dft의-또-다른-정의" id="toc-dft의-또-다른-정의" class="nav-link" data-scroll-target="#dft의-또-다른-정의">DFT의 또 다른 정의</a></li>
  <li><a href="#spectral-component-and-frequencies" id="toc-spectral-component-and-frequencies" class="nav-link" data-scroll-target="#spectral-component-and-frequencies">Spectral component and Frequencies</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="2022-12-24-Chap-8.3.out.ipynb" download="2022-12-24-Chap-8.3.out.ipynb"><i class="bi bi-journal-code"></i>Jupyter</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<div id="c46edd98-9fc9-4818-a774-fc646b84024d" class="cell" data-execution_count="513">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LinearAlgebra</span>, <span class="bu">FFTW</span></span></code></pre></div>
</div>
<section id="discrete-fourier-transform" class="level1 page-columns page-full">
<h1>Discrete Fourier Transform</h1>
<blockquote class="blockquote page-columns page-full">
<p><span class="citation" data-cites="djuric2018cooperative">Djuric and Richard (<a href="#ref-djuric2018cooperative" role="doc-biblioref">2018</a>)</span> 의 Chap. 8.3 의 내용중 일부를 요약함.</p>
<div class="no-row-height column-margin column-container"><div id="ref-djuric2018cooperative" class="csl-entry" role="listitem">
Djuric, Petar, and Cédric Richard. 2018. <em>Cooperative and Graph Signal Processing: Principles and Applications</em>. Academic Press.
</div></div></blockquote>
<section id="cyclic-shfit-operator-bf-b" class="level2">
<h2 class="anchored" data-anchor-id="cyclic-shfit-operator-bf-b">Cyclic shfit operator <span class="math inline">\({\bf B}\)</span></h2>
<p>The matrix <span class="math inline">\({\bf B}\)</span> representing the periodic shift is</p>
<div id="646f06be-b4fb-42da-bb31-862d33450a75" class="cell" data-execution_count="511">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>B<span class="op">=</span> [<span class="fl">0</span> <span class="fl">0</span> <span class="fl">0</span> <span class="fl">0</span> <span class="fl">1</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="fl">1</span> <span class="fl">0</span> <span class="fl">0</span> <span class="fl">0</span> <span class="fl">0</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0</span> <span class="fl">1</span> <span class="fl">0</span> <span class="fl">0</span> <span class="fl">0</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0</span> <span class="fl">0</span> <span class="fl">1</span> <span class="fl">0</span> <span class="fl">0</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0</span> <span class="fl">0</span> <span class="fl">0</span> <span class="fl">1</span> <span class="fl">0</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="511">
<pre><code>5×5 Matrix{Int64}:
 0  0  0  0  1
 1  0  0  0  0
 0  1  0  0  0
 0  0  1  0  0
 0  0  0  1  0</code></pre>
</div>
</div>
<p>This matrix is the cyclic shift.</p>
<p><em>note</em>: <span class="math inline">\({\bf B}\)</span> is orthogonal matrix.</p>
<div id="95e745ae-0c73-4b0a-a249-2fc2e5bc1762" class="cell" data-execution_count="477">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>B<span class="op">'</span>B</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="477">
<pre><code>5×5 Matrix{Int64}:
 1  0  0  0  0
 0  1  0  0  0
 0  0  1  0  0
 0  0  0  1  0
 0  0  0  0  1</code></pre>
</div>
</div>
<p>(ex1) Define <span class="math inline">\({\bf s}\)</span> as</p>
<div id="50a3f25e-5ab3-40cf-9888-795a7d7b7af4" class="cell" data-execution_count="478">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> [<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>]</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>s</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="478">
<pre><code>5-element Vector{Int64}:
 1
 2
 3
 4
 5</code></pre>
</div>
</div>
<p>Observe that</p>
<div id="650dcfc8-4c13-4a20-9efd-7581de006e7a" class="cell" data-execution_count="481">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>B<span class="op">*</span>s</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="481">
<pre><code>5-element Vector{Int64}:
 5
 1
 2
 3
 4</code></pre>
</div>
</div>
<div id="04b4674a-9981-4a52-aa71-904f492d6d3f" class="cell" data-execution_count="482">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>B<span class="op">^</span><span class="fl">2</span><span class="op">*</span>s</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="482">
<pre><code>5-element Vector{Int64}:
 4
 5
 1
 2
 3</code></pre>
</div>
</div>
<div id="3e28e0a3-1346-442d-a8a7-71181351d723" class="cell" data-execution_count="483">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>B<span class="op">^</span><span class="fl">3</span><span class="op">*</span>s</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="483">
<pre><code>5-element Vector{Int64}:
 3
 4
 5
 1
 2</code></pre>
</div>
</div>
<p>Thus we can interprete the matrix <span class="math inline">\({\bf B}\)</span> as cyclic shift operator such that</p>
<p><span class="math display">\[
{\bf B}s_n =s_{n-1}
\]</span></p>
<p>for <span class="math inline">\(n=1,\dots, N-1\)</span> and <span class="math inline">\({\bf B}s_0 =s_N\)</span>.</p>
<p><em>note:</em> <span class="math inline">\({\bf B}\)</span>는 시계열에서 다루는 backshift operator 와 비슷함.</p>
</section>
<section id="dft" class="level2">
<h2 class="anchored" data-anchor-id="dft">DFT</h2>
<p>The matrix <span class="math inline">\({\bf B}\)</span> can be expressed as</p>
<p><span class="math inline">\({\bf B}={\bf DFT}^\ast \cdot {\bf \Lambda} \cdot {\bf DFT}\)</span></p>
<p>where <span class="math inline">\({\bf DFT}\)</span> is unitary and symmetric matrix and <span class="math inline">\(\bf \Lambda\)</span> is diagonal matrix.</p>
<div id="771a033a-2b1d-4d81-97be-225f402cdf2e" class="cell" data-execution_count="484">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>λ, Ψ <span class="op">=</span> <span class="fu">eigen</span>(B)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="484">
<pre><code>Eigen{ComplexF64, ComplexF64, Matrix{ComplexF64}, Vector{ComplexF64}}
values:
5-element Vector{ComplexF64}:
 -0.8090169943749472 - 0.5877852522924725im
 -0.8090169943749472 + 0.5877852522924725im
 0.30901699437494734 - 0.9510565162951536im
 0.30901699437494734 + 0.9510565162951536im
  0.9999999999999998 + 0.0im
vectors:
5×5 Matrix{ComplexF64}:
  0.138197+0.425325im   0.138197-0.425325im  …  0.447214+0.0im
 -0.361803-0.262866im  -0.361803+0.262866im     0.447214+0.0im
  0.447214-0.0im        0.447214+0.0im          0.447214+0.0im
 -0.361803+0.262866im  -0.361803-0.262866im     0.447214+0.0im
  0.138197-0.425325im   0.138197+0.425325im     0.447214+0.0im</code></pre>
</div>
</div>
<div id="6f4b30dc-4d32-46f9-a90e-e40a2f1f8d1e" class="cell" data-execution_count="486">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>B <span class="op">≈</span> Ψ <span class="op">*</span> <span class="fu">Diagonal</span>(λ) <span class="op">*</span> Ψ<span class="ch">'</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="486">
<pre><code>true</code></pre>
</div>
</div>
<p>Define <span class="math inline">\({\boldsymbol \Psi}^\ast={\bf DFT}\)</span>.</p>
<div id="232d7690-fa90-4f8a-9435-46e5d140d217" class="cell" data-execution_count="487">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>DFT <span class="op">=</span> Ψ<span class="ch">'</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="487">
<pre><code>5×5 adjoint(::Matrix{ComplexF64}) with eltype ComplexF64:
  0.138197-0.425325im  -0.361803+0.262866im  …  0.138197+0.425325im
  0.138197+0.425325im  -0.361803-0.262866im     0.138197-0.425325im
 -0.361803-0.262866im  -0.361803+0.262866im     0.138197-0.425325im
 -0.361803+0.262866im  -0.361803-0.262866im     0.138197+0.425325im
  0.447214-0.0im        0.447214-0.0im          0.447214-0.0im</code></pre>
</div>
</div>
<p>Note that the eigenvalues are not ordered in julia.</p>
<div id="844c4a46-d13b-48fc-8bd1-942707334ad2" class="cell" data-execution_count="488">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>λ[<span class="fl">5</span>], <span class="fu">exp</span>(<span class="op">-</span><span class="cn">im</span><span class="op">*</span> <span class="fl">2</span>π<span class="op">/</span><span class="fl">5</span> <span class="op">*</span> <span class="fl">0</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="488">
<pre><code>(0.9999999999999998 + 0.0im, 1.0 - 0.0im)</code></pre>
</div>
</div>
<div id="8c7ff0b2-570a-4959-ac76-090795447c90" class="cell" data-execution_count="489">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>λ[<span class="fl">3</span>], <span class="fu">exp</span>(<span class="op">-</span><span class="cn">im</span><span class="op">*</span> <span class="fl">2</span>π<span class="op">/</span><span class="fl">5</span> <span class="op">*</span> <span class="fl">1</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="489">
<pre><code>(0.30901699437494734 - 0.9510565162951536im, 0.30901699437494745 - 0.9510565162951535im)</code></pre>
</div>
</div>
<div id="6d3050fb-3fa7-45b3-b90a-54492e1bd3c2" class="cell" data-execution_count="490">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>λ[<span class="fl">1</span>], <span class="fu">exp</span>(<span class="op">-</span><span class="cn">im</span><span class="op">*</span> <span class="fl">2</span>π<span class="op">/</span><span class="fl">5</span> <span class="op">*</span> <span class="fl">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="490">
<pre><code>(-0.8090169943749472 - 0.5877852522924725im, -0.8090169943749473 - 0.5877852522924732im)</code></pre>
</div>
</div>
<div id="3563717f-0058-4997-acb0-17960a575442" class="cell" data-execution_count="491">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>λ[<span class="fl">2</span>], <span class="fu">exp</span>(<span class="op">-</span><span class="cn">im</span><span class="op">*</span> <span class="fl">2</span>π<span class="op">/</span><span class="fl">5</span> <span class="op">*</span> <span class="fl">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="491">
<pre><code>(-0.8090169943749472 + 0.5877852522924725im, -0.8090169943749475 + 0.587785252292473im)</code></pre>
</div>
</div>
</section>
<section id="spectral-components-and-frequencies" class="level2">
<h2 class="anchored" data-anchor-id="spectral-components-and-frequencies">Spectral components and Frequencies</h2>
<p>We remark:</p>
<p><strong>(1) Spectral components</strong>: For <span class="math inline">\(k = 0,1,2,\dots, N-1\)</span>, the <span class="math inline">\(k\)</span>-th column of <span class="math inline">\({\bf DFT}^\ast\)</span> is defined by</p>
<p><span class="math display">\[\Psi_k:=\frac{1}{\sqrt{N}}\begin{bmatrix} 1 \\ e^{j\frac{2\pi}{N}k} \\ e^{j\frac{2\pi}{N}2k} \\ e^{j\frac{2\pi}{N}3k} \\  \dots \\ e^{j\frac{2\pi}{N}(N-1)k} \end{bmatrix}.\]</span></p>
<p>Note that <span class="math inline">\(\Psi_k\)</span> can be also interpreted as <span class="math inline">\(\ell\)</span>-th eigenvector of <span class="math inline">\({\bf A}\)</span> correspoding <span class="math inline">\(\lambda_\ell = e^{-j\frac{2\pi}{N}k}\)</span>. Those eigenvectors</p>
<p><span class="math display">\[\big\{{\bf 1},\Psi_1,\Psi_2, \dots, \Psi_{N-1}\big\}\]</span></p>
<p>form a complete orthonomal basis of <span class="math inline">\(\mathbb{C}^N\)</span>. These vectors are called spectral components.</p>
<p><strong>(2) Frequencies:</strong> The diagonal entries of <span class="math inline">\({\bf \Lambda}\)</span> are the eigenvalues of the time shift <span class="math inline">\({\bf B}\)</span>. In Physics and in operator theory, these eigenvalues are the frequencies of the signal. In DSP it is more common to call frequencies</p>
<p><span class="math display">\[\Omega_k=\frac{-1}{2\pi j}\ln\lambda_k=\frac{-1}{2\pi j}\ln e^{-j \frac{2\pi}{N}k}=\frac{k}{N}, \quad k=0,1,2,\dots,N-1.\]</span></p>
<hr>
<p>The <span class="math inline">\(N\)</span> (time) frequencies <span class="math inline">\(\Omega_k\)</span> are all distinct, positive, equally spaced, and increasing from <span class="math inline">\(0\)</span> to <span class="math inline">\(\frac{N-1}{N}\)</span>. The spectral components are the complex exponential sinusiodal functions. For example, corresponding to the zero frequency is the DC spectral component (a vector whose entries are constant and all equal to <span class="math inline">\(\frac{1}{\sqrt{N}}\)</span>).</p>
</section>
</section>
<section id="내-마음대로-summary" class="level1 page-columns page-full">
<h1>내 마음대로 Summary</h1>
<section id="dft-1" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="dft-1">DFT</h2>
<p>일반적으로 우리가 알고있는 DFT<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>는 아래와 같다. (이 그림은 <a href="https://en.wikipedia.org/wiki/Discrete_Fourier_transform">위키피디아</a>에서 캡쳐한 것이다)</p>
<div class="no-row-height column-margin column-container"><li id="fn1"><p><sup>1</sup>&nbsp;discrete Fourier transform</p></li></div><div class="img-fluid quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="2022-12-24-Chap-8.3_files/figure-html/d3025f89-333d-4e4d-8710-662dccf51cf5-1-c02def0a-947e-4239-b928-bf699d496cbb.png" class="img-fluid figure-img"></p>
<figcaption>그림1: 위키에서 긁어온 DFT의 정의</figcaption>
</figure>
</div>
<p>즉 DFT는 임의의 신호 <span class="math inline">\(\{{\bf x}_n\}:=x_0,x_1,\dots,x_{N-1}\)</span>를 적당한 규칙<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>에 따라서 <span class="math inline">\(\{{\bf X}_k\}:=X_0,X_1,\dots,X_{N-1}\)</span>로 바꾸는 변환을 이라고 이해할 수 있다. 이때 사용되는 적당한 규칙은 구체적으로 아래의 수식을 의미한다.</p>
<div class="no-row-height column-margin column-container"><li id="fn2"><p><sup>2</sup>&nbsp;<span class="math inline">\(X_k = \sum_{n=0}^{N-1}x_n\cdot e^{-i\frac{2\pi}{N}kn}\)</span></p></li></div><p><span class="math display">\[X_k = \sum_{n=0}^{N-1}x_n\cdot e^{-i\frac{2\pi}{N}kn}\]</span></p>
<p>그런데 매트릭스를 활용하면 위의 수식을 아래와 같이 표현할 수 있다.</p>
<p><span class="math display">\[\begin{bmatrix} X_1 \\ X_2 \\ X_3 \\ \dots \\ X_{N-1} \end{bmatrix}
=\begin{bmatrix}
1 &amp; 1 &amp; 1 &amp; \dots &amp; 1 \\
1 &amp; e^{-i \frac{2\pi}{N}\cdot 1} &amp; e^{-i \frac{2\pi}{N}\cdot 2} &amp; \dots &amp; e^{-i \frac{2\pi}{N}\cdot (N-1)}\\
1 &amp; e^{-i \frac{2\pi}{N}\cdot 2} &amp; e^{-i \frac{2\pi}{N}\cdot 4} &amp; \dots &amp; e^{-i \frac{2\pi}{N}\cdot 2(N-1)}\\
\dots &amp; \dots &amp; \dots &amp; \dots &amp; \dots \\
1 &amp; e^{-i \frac{2\pi}{N}\cdot (N-1)} &amp; e^{-i \frac{2\pi}{N}\cdot 2(N-1)} &amp; \dots &amp; e^{-i \frac{2\pi}{N}\cdot (N-1)^2}
\end{bmatrix}
\begin{bmatrix} x_1 \\ x_2 \\ x_3 \\ \dots \\ x_{N-1} \end{bmatrix}\]</span></p>
<p>편의상 <span class="math inline">\({\bf X}\)</span>와 <span class="math inline">\({\bf x}\)</span>를 <span class="math inline">\(N \times 1\)</span> col-vec이라고 생각하고 DFT를 아래와 같은 matrix로 정의하자.</p>
<p><span class="math display">\[{\bf DFT} = \begin{bmatrix}
1 &amp; 1 &amp; 1 &amp; \dots &amp; 1 \\
1 &amp; e^{-i \frac{2\pi}{N}\cdot 1} &amp; e^{-i \frac{2\pi}{N}\cdot 2} &amp; \dots &amp; e^{-i \frac{2\pi}{N}\cdot (N-1)}\\
1 &amp; e^{-i \frac{2\pi}{N}\cdot 2} &amp; e^{-i \frac{2\pi}{N}\cdot 4} &amp; \dots &amp; e^{-i \frac{2\pi}{N}\cdot 2(N-1)}\\
\dots &amp; \dots &amp; \dots &amp; \dots &amp; \dots \\
1 &amp; e^{-i \frac{2\pi}{N}\cdot (N-1)} &amp; e^{-i \frac{2\pi}{N}\cdot 2(N-1)} &amp; \dots &amp; e^{-i \frac{2\pi}{N}\cdot (N-1)^2}
    \end{bmatrix}\]</span></p>
<p>그러면</p>
<p><span class="math display">\[{\bf X} = {\bf DFT} \cdot {\bf x}\]</span></p>
<p>와 같이 표현할 수 있고 <span class="math inline">\({\bf x}\)</span>에서 <span class="math inline">\({\bf X}\)</span>로 바꾸는 과정을 단순히 <span class="math inline">\({\bf DFT}\)</span>행렬을 <span class="math inline">\({\bf x}\)</span>의 왼쪽에 곱하는 과정으로 이해할 수 있다.</p>
<p>(참고) 사실 아래와 같이 <span class="math inline">\({\bf DFT}\)</span>를 정의하는 버전도 있다. (둘이 혼용해서 쓰인다)</p>
<p><span class="math display">\[{\bf DFT} = \frac{1}{\sqrt{N}}\begin{bmatrix}
1 &amp; 1 &amp; 1 &amp; \dots &amp; 1 \\
1 &amp; e^{-i \frac{2\pi}{N}\cdot 1} &amp; e^{-i \frac{2\pi}{N}\cdot 2} &amp; \dots &amp; e^{-i \frac{2\pi}{N}\cdot (N-1)}\\
1 &amp; e^{-i \frac{2\pi}{N}\cdot 2} &amp; e^{-i \frac{2\pi}{N}\cdot 4} &amp; \dots &amp; e^{-i \frac{2\pi}{N}\cdot 2(N-1)}\\
\dots &amp; \dots &amp; \dots &amp; \dots &amp; \dots \\
1 &amp; e^{-i \frac{2\pi}{N}\cdot (N-1)} &amp; e^{-i \frac{2\pi}{N}\cdot 2(N-1)} &amp; \dots &amp; e^{-i \frac{2\pi}{N}\cdot (N-1)^2}
    \end{bmatrix}\]</span></p>
<hr>
<p><strong>예제1</strong> 아래는 위키에서 긁어온 예제이다. 이 예제를 따라가보자.</p>
<div class="img-fluid quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="2022-12-24-Chap-8.3_files/figure-html/dbcb0d0c-518c-4f75-8392-bf0b263deb68-1-f5239d47-a397-4efe-aa7f-31a026383ac2.png" class="img-fluid figure-img"></p>
<figcaption>그림2: 위키에서 긁어온 예제이미지</figcaption>
</figure>
</div>
<p>예제를 풀기위해서 우선 아래와 같은 벡터를 선언하다.</p>
<div id="b8792912-4e5a-4ee9-8380-d195380b6984" class="cell" data-execution_count="514">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> [<span class="fl">1</span>, <span class="fl">2</span><span class="op">-</span><span class="cn">im</span>, <span class="op">-</span><span class="cn">im</span>, <span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fl">2im</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="514">
<pre><code>4-element Vector{Complex{Int64}}:
  1 + 0im
  2 - 1im
  0 - 1im
 -1 + 2im</code></pre>
</div>
</div>
<p>(풀이1)</p>
<p><span class="math inline">\(4\times 4\)</span>의 크기를 가지는 DFT행렬을 선언한다.</p>
<p>(step1) 아래의 매트릭스 생성</p>
<div id="885d894a-86ba-44d4-aa2e-a2da08f250cd" class="cell" data-execution_count="515">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>_DFT <span class="op">=</span> <span class="fu">reshape</span>([i<span class="op">*</span>j for i <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span><span class="fl">3</span> for j <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span><span class="fl">3</span>], (<span class="fl">4</span>,<span class="fl">4</span>))</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>_DFT</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="515">
<pre><code>4×4 Matrix{Int64}:
 0  0  0  0
 0  1  2  3
 0  2  4  6
 0  3  6  9</code></pre>
</div>
</div>
<p>(step2) <code>_DFT</code>의 각 원소에 함수 <span class="math inline">\(f: x \to \exp(-i\frac{2\pi}{4}x)\)</span>를 취함</p>
<div id="bc1e08cc-da9a-4818-b269-2494f1a9e322" class="cell" data-execution_count="516">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> x <span class="op">-&gt;</span> <span class="fu">exp</span>(<span class="op">-</span><span class="cn">im</span> <span class="op">*</span> (<span class="fl">2</span>π<span class="op">/</span><span class="fl">4</span>) <span class="op">*</span> x)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>DFT <span class="op">=</span> _DFT <span class="op">.|&gt;</span> f</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="516">
<pre><code>4×4 Matrix{ComplexF64}:
 1.0-0.0im           1.0-0.0im          …           1.0-0.0im
 1.0-0.0im   6.12323e-17-1.0im             -1.83697e-16+1.0im
 1.0-0.0im          -1.0-1.22465e-16im             -1.0-3.67394e-16im
 1.0-0.0im  -1.83697e-16+1.0im              5.51091e-16-1.0im</code></pre>
</div>
</div>
<p>이제 <span class="math inline">\({\bf X}\)</span>를 구하면 아래와 같다.</p>
<div id="374d3c92-210c-48c6-9a6e-f5636707036d" class="cell" data-execution_count="517">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>DFT <span class="op">*</span> x</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="517">
<pre><code>4-element Vector{ComplexF64}:
                   2.0 + 0.0im
   -1.9999999999999998 - 2.0000000000000004im
 8.881784197001252e-16 - 1.9999999999999998im
    3.9999999999999987 + 4.000000000000001im</code></pre>
</div>
</div>
<p>위키의 답이 잘 나옴</p>
<p>(풀이2)</p>
<p>참고로 아래와 같이 패키지를 이용하여 구할 수도 있다.</p>
<div id="000648e1-c06a-4fd6-a97f-e2166b0e4617" class="cell" data-execution_count="518">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fft</span>(x)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="518">
<pre><code>4-element Vector{ComplexF64}:
  2.0 + 0.0im
 -2.0 - 2.0im
  0.0 - 2.0im
  4.0 + 4.0im</code></pre>
</div>
</div>
</section>
<section id="inverse-dft" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="inverse-dft">Inverse DFT</h2>
<p>앞으로는 <span class="math inline">\({\bf DFT}\)</span>를 아래와 같이 정의하자.</p>
<p><span class="math display">\[{\bf DFT} = \frac{1}{\sqrt{N}}\begin{bmatrix}
1 &amp; 1 &amp; 1 &amp; \dots &amp; 1 \\
1 &amp; e^{-i \frac{2\pi}{N}\cdot 1} &amp; e^{-i \frac{2\pi}{N}\cdot 2} &amp; \dots &amp; e^{-i \frac{2\pi}{N}\cdot (N-1)}\\
1 &amp; e^{-i \frac{2\pi}{N}\cdot 2} &amp; e^{-i \frac{2\pi}{N}\cdot 4} &amp; \dots &amp; e^{-i \frac{2\pi}{N}\cdot 2(N-1)}\\
\dots &amp; \dots &amp; \dots &amp; \dots &amp; \dots \\
1 &amp; e^{-i \frac{2\pi}{N}\cdot (N-1)} &amp; e^{-i \frac{2\pi}{N}\cdot 2(N-1)} &amp; \dots &amp; e^{-i \frac{2\pi}{N}\cdot (N-1)^2}
    \end{bmatrix}\]</span></p>
<p><span class="math inline">\({\bf DFT}\)</span>행렬에는 몇 가지 특징이 있다.</p>
<p><strong>특징1:</strong> 유니터리행렬이다. 즉 <span class="math inline">\({\bf DFT}^\ast \cdot {\bf DFT} = {\bf DFT}^\ast \cdot{\bf DFT} = {\bf I}\)</span> 이다.</p>
<div id="8ecd82dd-a62c-4fbc-869f-2c06c545ccf7" class="cell" data-execution_count="469">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>_DFT <span class="op">=</span> <span class="fu">reshape</span>([i<span class="op">*</span>j for i <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span><span class="fl">3</span> for j <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span><span class="fl">3</span>], (<span class="fl">4</span>,<span class="fl">4</span>))</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> x <span class="op">-&gt;</span> <span class="fu">exp</span>(<span class="op">-</span><span class="cn">im</span> <span class="op">*</span> (<span class="fl">2</span>π<span class="op">/</span><span class="fl">4</span>) <span class="op">*</span> x)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>DFT <span class="op">=</span> _DFT <span class="op">.|&gt;</span> f</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>DFT <span class="co"># 아까의 예제의 DFT!</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="469">
<pre><code>4×4 Matrix{ComplexF64}:
 1.0-0.0im           1.0-0.0im          …           1.0-0.0im
 1.0-0.0im   6.12323e-17-1.0im             -1.83697e-16+1.0im
 1.0-0.0im          -1.0-1.22465e-16im             -1.0-3.67394e-16im
 1.0-0.0im  -1.83697e-16+1.0im              5.51091e-16-1.0im</code></pre>
</div>
</div>
<div id="b2752706-2cc9-4b57-935a-3c31735ad4fb" class="cell" data-execution_count="470">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>DFT <span class="op">=</span> (<span class="fl">1</span><span class="op">/</span>√<span class="fl">4</span>)<span class="op">*</span>DFT <span class="co"># 새로운 DFT의 정의 </span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>DFT<span class="op">'</span>DFT <span class="op">.|&gt;</span> round <span class="co"># 유니터리행렬임을 확인!</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="470">
<pre><code>4×4 Matrix{ComplexF64}:
  1.0+0.0im  -0.0-0.0im   0.0-0.0im   0.0-0.0im
 -0.0+0.0im   1.0+0.0im  -0.0-0.0im   0.0-0.0im
  0.0+0.0im  -0.0+0.0im   1.0+0.0im  -0.0-0.0im
  0.0+0.0im   0.0+0.0im  -0.0+0.0im   1.0+0.0im</code></pre>
</div>
</div>
<p><strong>특징2:</strong> <span class="math inline">\({\bf DFT}\)</span>는 대칭행렬이다. 따라서 이 행렬의 켤레전치는 DFT의 각 원소에서 단순히 <span class="math inline">\(i=\sqrt{-1}\)</span> 대신에 <span class="math inline">\(-i\)</span> 를 넣은 것과 같다.</p>
<p>특징1-2를 조합하면 아래와 같이 <span class="math inline">\({\bf DFT}\)</span>에서 <span class="math inline">\(i\)</span> 대신에 <span class="math inline">\(-i\)</span>를 넣은 행렬이 변환 DFT를 취소시킬 수 있음을 이해할 수 있다. <a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<div class="no-row-height column-margin column-container"><li id="fn3"><p><sup>3</sup>&nbsp;아래의 행렬은 <span class="math inline">\({\bf DFT}^\ast\)</span> 혹은 <span class="math inline">\({\bf DFT}\)</span>의 conjugate matrix 혹은 <span class="math inline">\({\bf DFT}^{-1}\)</span>로 생각할 수 있음</p></li></div><p><span class="math display">\[\frac{1}{\sqrt{N}}\begin{bmatrix}
1 &amp; 1 &amp; 1 &amp; \dots &amp; 1 \\
1 &amp; e^{i \frac{2\pi}{N}\cdot 1} &amp; e^{i \frac{2\pi}{N}\cdot 2} &amp; \dots &amp; e^{i \frac{2\pi}{N}\cdot (N-1)}\\
1 &amp; e^{i \frac{2\pi}{N}\cdot 2} &amp; e^{i \frac{2\pi}{N}\cdot 4} &amp; \dots &amp; e^{i \frac{2\pi}{N}\cdot 2(N-1)}\\
\dots &amp; \dots &amp; \dots &amp; \dots &amp; \dots \\
1 &amp; e^{i \frac{2\pi}{N}\cdot (N-1)} &amp; e^{i \frac{2\pi}{N}\cdot 2(N-1)} &amp; \dots &amp; e^{i \frac{2\pi}{N}\cdot (N-1)^2}
    \end{bmatrix}\]</span></p>
<p>행렬 <span class="math inline">\({\bf DFT}\)</span>를 discrete Fourier transform으로 생각했듯이 위의 행렬을 inverse discrete Fourier transform으로 해석할 수 있다.</p>
</section>
<section id="dft의-또-다른-정의" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="dft의-또-다른-정의">DFT의 또 다른 정의</h2>
<p>이번에는 <span class="math inline">\({\bf DFT}\)</span>에 대한 다른 정의를 생각해보자. 우선 아래와 같은 행렬 <span class="math inline">\({\bf B}\)</span>를 고려하자.</p>
<div id="31f2e5a7-11ee-40e3-bc45-adfe1b5447dc" class="cell" data-execution_count="512">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>B<span class="op">=</span> [<span class="fl">0</span> <span class="fl">0</span> <span class="fl">0</span> <span class="fl">1</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    <span class="fl">1</span> <span class="fl">0</span> <span class="fl">0</span> <span class="fl">0</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0</span> <span class="fl">1</span> <span class="fl">0</span> <span class="fl">0</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0</span> <span class="fl">0</span> <span class="fl">1</span> <span class="fl">0</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="512">
<pre><code>4×4 Matrix{Int64}:
 0  0  0  1
 1  0  0  0
 0  1  0  0
 0  0  1  0</code></pre>
</div>
</div>
<p>이것은 길이가 4인 임의의 column vector를 아래로 한칸씩 이동시키는 매트릭스이다.</p>
<div id="22e3f491-1997-44a0-ba52-87ed6bb064de" class="cell" data-execution_count="499">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> [<span class="fl">1</span>, <span class="fl">2</span><span class="op">-</span><span class="cn">im</span>, <span class="op">-</span><span class="cn">im</span>, <span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fl">2im</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="499">
<pre><code>4-element Vector{Complex{Int64}}:
  1 + 0im
  2 - 1im
  0 - 1im
 -1 + 2im</code></pre>
</div>
</div>
<div id="456b5994-4ad3-44a3-bac7-22d39ff2a02a" class="cell" data-execution_count="500">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>B<span class="op">*</span>x <span class="co"># 아래로 한칸이동 </span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="500">
<pre><code>4-element Vector{Complex{Int64}}:
 -1 + 2im
  1 + 0im
  2 - 1im
  0 - 1im</code></pre>
</div>
</div>
<div id="a7dc5890-ee20-40f9-b913-d7248dedb505" class="cell" data-execution_count="501">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>B<span class="op">^</span><span class="fl">2</span><span class="op">*</span>x <span class="co"># 아래로 두칸이동, B^2*x = B*(Bx) 이므로 </span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="501">
<pre><code>4-element Vector{Complex{Int64}}:
  0 - 1im
 -1 + 2im
  1 + 0im
  2 - 1im</code></pre>
</div>
</div>
<p>한편 이 매트릭스 <span class="math inline">\({\bf B}\)</span>는 아래와 같이 고유분해가 가능하다.</p>
<p><span class="math display">\[ {\bf B} = {\bf \Psi} {\bf \Lambda} {\bf \Psi}^\ast\]</span></p>
<ul>
<li><span class="math inline">\({\bf \Psi}\)</span>: make <span class="math inline">\(\frac{1}{\sqrt{N}}[e^{\sqrt{-1} \frac{2\pi}{N} ij}~\text{ for }~ i=0,1,2,\dots,N-1~\text{ for }~j=0,1,2,\dots,N-1]\)</span> and apply <code>reshape</code> function with <span class="math inline">\((N,N)\)</span>.</li>
<li><span class="math inline">\({\bf \Lambda}\)</span>: make <span class="math inline">\([e^{-\sqrt{-1}\frac{2\pi}{N}i}~\text{ for }~ i=0,1,2\dots,N-1]\)</span> and apply <code>Diagonal</code> function.</li>
</ul>
<div id="08326266-a871-4379-8347-8c61339b3053" class="cell" data-execution_count="510">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="fl">4</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>λ <span class="op">=</span> [<span class="fu">exp</span>(<span class="op">-</span><span class="cn">im</span> <span class="op">*</span> (<span class="fl">2</span>π<span class="op">/</span>N) <span class="op">*</span>i) for i <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span>(N<span class="op">-</span><span class="fl">1</span>)]</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>Λ <span class="op">=</span> <span class="fu">Diagonal</span>(λ)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>_Ψ <span class="op">=</span> <span class="fl">1</span><span class="op">/</span>√N <span class="op">*</span>[<span class="fu">exp</span>(<span class="cn">im</span> <span class="op">*</span> (<span class="fl">2</span>π<span class="op">/</span>N) <span class="op">*</span> i<span class="op">*</span>j) for i <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span>(N<span class="op">-</span><span class="fl">1</span>) for j <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span>(N<span class="op">-</span><span class="fl">1</span>)]</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>Ψ <span class="op">=</span> <span class="fu">reshape</span>(_Ψ, (N,N))</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>B <span class="op">≈</span> Ψ <span class="op">*</span> Λ <span class="op">*</span> Ψ<span class="ch">'</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="510">
<pre><code>true</code></pre>
</div>
</div>
<p>그런데 위에서 정의된 <span class="math inline">\({\bf \Psi}^\ast\)</span>는 우리가 그전에 정의하였던 <span class="math inline">\({\bf DFT}\)</span>의 행렬과 같다.</p>
<div id="da21f4ff-7297-457d-838f-946fcb57d73a" class="cell" data-execution_count="505">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>_DFT <span class="op">=</span> <span class="fu">reshape</span>([i<span class="op">*</span>j for i <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span><span class="fl">3</span> for j <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span><span class="fl">3</span>], (<span class="fl">4</span>,<span class="fl">4</span>))</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>DFT <span class="op">=</span> _DFT <span class="op">.|&gt;</span> (x <span class="op">-&gt;</span> <span class="fu">exp</span>(<span class="op">-</span><span class="cn">im</span> <span class="op">*</span> (<span class="fl">2</span>π<span class="op">/</span><span class="fl">4</span>) <span class="op">*</span> x)) </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>DFT <span class="op">=</span> DFT <span class="op">*</span> <span class="fl">1</span><span class="op">/</span>√N</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="505">
<pre><code>4×4 Matrix{ComplexF64}:
 0.5-0.0im           0.5-0.0im          …           0.5-0.0im
 0.5-0.0im   3.06162e-17-0.5im             -9.18485e-17+0.5im
 0.5-0.0im          -0.5-6.12323e-17im             -0.5-1.83697e-16im
 0.5-0.0im  -9.18485e-17+0.5im              2.75546e-16-0.5im</code></pre>
</div>
</div>
<div id="637c2c4b-ca04-4505-bf33-e6ad934081f2" class="cell" data-execution_count="506">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>Ψ<span class="ch">' == DFT </span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="506">
<pre><code>true</code></pre>
</div>
</div>
<p>결국 요약하면 길이가 <span class="math inline">\(N\)</span>인 신호의 <span class="math inline">\({\bf DFT}\)</span>행렬은 아래의 과정으로 구할 수 있음을 알 수 있다.</p>
<ol type="1">
<li>Forward operator <span class="math inline">\({\bf A}\)</span>를 정의한다.</li>
<li><span class="math inline">\({\bf A}\)</span>의 고유벡터행렬 <span class="math inline">\({\bf \Psi}\)</span>을 구한다. <a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></li>
<li><span class="math inline">\({\bf \Psi}\)</span>의 conjugate transpose matrix <span class="math inline">\({\bf \Psi}^\ast\)</span> 를 구한다. 이것이 <span class="math inline">\({\bf DFT}\)</span> matrix 이다. <a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></li>
</ol>
<div class="no-row-height column-margin column-container"><li id="fn4"><p><sup>4</sup>&nbsp;고유벡터행렬은 고유값 <span class="math inline">\(e^{-\sqrt{-1}\frac{2\pi}{N}i}\)</span>에 의하여 정렬되어 있어야 함.</p></li><li id="fn5"><p><sup>5</sup>&nbsp;사실 이미 대칭행렬이므로 conjugate matrix만 구하면 된다.</p></li></div></section>
<section id="spectral-component-and-frequencies" class="level2">
<h2 class="anchored" data-anchor-id="spectral-component-and-frequencies">Spectral component and Frequencies</h2>
<p><span class="math inline">\({\bf A}\)</span>의 고유벡터 <span class="math inline">\({\bf \Psi}\)</span>의 각 column을 spectral component라고 부른다.</p>
<div id="a4f57f51-d36a-4e76-9fb9-9296368b0b91" class="cell" data-execution_count="507">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>ψ₁ <span class="op">=</span> Ψ[<span class="op">:</span>,<span class="fl">1</span>] <span class="co"># ψ₁ is first spectral component </span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>ψ₂ <span class="op">=</span> Ψ[<span class="op">:</span>,<span class="fl">2</span>] <span class="co"># ψ₂ is seconde spectral component </span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>ψ₃ <span class="op">=</span> Ψ[<span class="op">:</span>,<span class="fl">3</span>] <span class="co"># ψ₃ is third spectral component </span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>ψ₄ <span class="op">=</span> Ψ[<span class="op">:</span>,<span class="fl">4</span>] <span class="co"># ψ₄ is last spectral component</span></span></code></pre></div>
</div>
<p>그리고 아래와 같은 수열을 <span class="math inline">\(\Omega_{k}=\frac{k}{N}\)</span>을 frequency 라고 부른다.</p>
<div id="69135b90-fe33-42d0-b312-036aa30ca4f4" class="cell" data-execution_count="508">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>N<span class="op">=</span><span class="fl">4</span> </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>Ω <span class="op">=</span> [k<span class="op">/</span>N for k <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span>(N<span class="op">-</span><span class="fl">1</span>)]</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>Ω</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="508">
<pre><code>4-element Vector{Float64}:
 0.0
 0.25
 0.5
 0.75</code></pre>
</div>
</div>



</section>
</section>


</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="seoyeonc/sy_hub" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->




</body></html>