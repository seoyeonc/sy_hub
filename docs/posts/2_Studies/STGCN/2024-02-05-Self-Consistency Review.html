<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.527">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="SEOYEON CHOI">
<meta name="dcterms.date" content="2024-02-05">

<title>Seoyeon’s Blog - Review: Self-Consistency: A Fundamental Concept in Statistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Seoyeon’s Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://seoyeonc.github.io/md/"> 
<span class="menu-text">Lectures_ing</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://seoyeonc.github.io/chch/"> 
<span class="menu-text">Lectures_fastai</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://seoyeonc.github.io/Research_area/"> 
<span class="menu-text">Research_ing</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://seoyeonc.github.io/ms/"> 
<span class="menu-text">Research_fastai</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://seoyeonc.github.io/GODE_blog/"> 
<span class="menu-text">GODE</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://seoyeonc.github.io/HCAM_blog/"> 
<span class="menu-text">HCAM</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://seoyeonc.github.io/ITTGNN_blog/"> 
<span class="menu-text">ITTGNN</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://seoyeonc.github.io/julia/"> 
<span class="menu-text">Julia</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/seoyeonc"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Review: Self-Consistency: A Fundamental Concept in Statistics</li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Review: Self-Consistency: A Fundamental Concept in Statistics</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>SEOYEON CHOI </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 5, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../1_note.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Note</strong></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text"><strong>Studies</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2_graph.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Graph</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2_ept.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EPT</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2_stgcn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Related to STGCN</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#import" id="toc-import" class="nav-link active" data-scroll-target="#import">Import</a></li>
  <li><a href="#self-consistent-random-vectors" id="toc-self-consistent-random-vectors" class="nav-link" data-scroll-target="#self-consistent-random-vectors">2. Self-Consistent Random Vectors</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="2024-02-05-Self-Consistency Review.out.ipynb" download="2024-02-05-Self-Consistency Review.out.ipynb"><i class="bi bi-journal-code"></i>Jupyter</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p><strong>Y = Observed Data, X = Completed Data</strong> 로 이해하며 읽을 것</p>
<p><a href="https://projecteuclid.org/journals/statistical-science/volume-11/issue-3/Self-consistency-a-fundamental-concept-in-statistics/10.1214/ss/1032280215.full">Paper link</a></p>
<section id="import" class="level1">
<h1>Import</h1>
<div id="664c2de6-42ed-4a7f-bab6-e1a2e9e05a70" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code></pre></div>
</div>
</section>
<section id="self-consistent-random-vectors" class="level1">
<h1>2. Self-Consistent Random Vectors</h1>
<p>Suppose we want to represent or approximate the distribution of a random vector <span class="math inline">\(\bf{X}\)</span> by a random vector <span class="math inline">\(\bf{Y}\)</span> whose structure is less complex.</p>
<p>구조가 간단한(?) 확률벡터 Y로 확률벡터 X의 분포를 근사하거나 나타내려 한다고 하자.</p>
<p>One measure of how well <span class="math inline">\(\bf{Y}\)</span> approximates <span class="math inline">\(\bf{X}\)</span> is the mean squared error <span class="math inline">\(\cal{E}||\bf{X}-\bf{Y}||^2\)</span>.</p>
<p>Y로 X의 근사값을 잘 찾는 한 측정치는 평균제곱오차를 구하는 것이다.</p>
<p>In terms of mean squarred error, the approximation of <span class="math inline">\(\bf{X}\)</span> by <span class="math inline">\(\bf{Y}\)</span> can always be improved using <span class="math inline">\(\cal{E} [\bf{X}|\bf{Y}]\)</span> since, for any function <span class="math inline">\(g\)</span>, <span class="math inline">\(\cal{E} ||\bf{X}-\cal{E} [\bf{X}|\bf{Y}]||^2 \le \cal{E} ||\bf{X}-g(\bf{Y})||^2\)</span>.</p>
<p>평균제곱오차에 관해 말하자면, Y에 의해 X의 근사치는 항상 Y 가 주어졌을때 X의 기대값으로 개선될 수 있는데, 어느 함수 g에 대해서나 위의 식이 성립한다.</p>
<ul>
<li><span class="math inline">\(\cal{E}\)</span><span class="math inline">\(||\bf{X}-\cal{E} [\bf{X}|\bf{Y}]||^2\)</span> 이게 최솟값이라는 뜻</li>
</ul>
<p>Taking <span class="math inline">\(g\)</span> to be the identity gives <span class="math inline">\(\cal{E} || \bf{X} - \cal{E} [\bf{X}|\bf{Y}]||^2 \le \cal{E} ||\bf{X}-\bf{Y}||^2\)</span>.</p>
<p>함수 g에 Y를 주면, 위의 식이 된다.</p>
<ul>
<li>E[X|Y] =Y일때 Y가 X에 대해 self-cosistent 하다고 헀으니까 함수 g(Y) = Y라 한다면?</li>
</ul>
<p>Thus the random vector <span class="math inline">\(Y\)</span> is locally optimal for approximating <span class="math inline">\(\bf{X}\)</span> if <span class="math inline">\(\bf{Y} = \cal{E} [\bf{X}|\bf{Y}]\)</span>, in which case we call <span class="math inline">\(Y\)</span> self-consistent for <span class="math inline">\(\bf{X}\)</span>.</p>
<p>만일 Y가 Y가 주어졌을때 X의 기댓값과 같다면, 확률벡터 Y는 X에 근사하는데 있어 locally optimal 하다. 이때, Y를 X에 대해 self-consistent 하다고 부른다.</p>
<ul>
<li><span class="math inline">\(\cal{E}\)</span><span class="math inline">\(||\bf{X}-\cal{E} [\bf{X}|\bf{Y}]||^2\)</span> 계산할때에 대해(locally) E(X|Y) = Y라면, 최적의 값(최소의 값, optimal)하다.</li>
</ul>
<p><span style="background-color:#CCCCFF"> <strong>DEFINITION 2.1.</strong> </span> For two jointly distributed random vectors <span class="math inline">\(\bf{X}\)</span> and <span class="math inline">\(\bf{Y}\)</span>, we say that <span class="math inline">\(\bf{Y}\)</span> is self-consistent for <span class="math inline">\(\bf{X}\)</span> if <span class="math inline">\(\cal{E} (\bf{X}|\bf{Y}) = \bf{Y}\)</span> almost surely.</p>
<p>두 결합 분포된 확률벡터 X와 Y에 대해 Y가 주어졌을때 X의 기댓값이 Y와 동일하다면 Y를 X에 대해 self-consistent 하다고 한다.</p>
<p><code>1</code> <span class="math inline">\(\bf{Y} = \bf{X} + \epsilon\)</span> <span class="math inline">\((\epsilon \sim i.i.d.)\)</span>이라면, <span class="math inline">\(E(X|Y) = Y\)</span> <span class="math inline">\(Y\)</span>는 <span class="math inline">\(X\)</span>에 대해 self-consistent 하다.</p>
<p><code>2</code> <span class="math inline">\(\bar{X} = \frac{1}{3}(x_1+x_2+x_3)\)</span>, <span class="math inline">\(\tilde{X} = \frac{1}{3}(\mu +x_2+x_3)\)</span>, <span class="math inline">\(E(\bar{X}|\tilde{X}) = \frac{1}{3}E(x_1) + \tilde{X} - \frac{1}{3}\mu \tilde{X} = \tilde{X}\)</span> <span class="math inline">\(\tilde{X}\)</span>는 <span class="math inline">\(\bar{X}\)</span>에 대해 self-consistent 하다.</p>
<p>We will assume implicitly that moments exist as required.</p>
<p>필요에 따라 이런 moment가 존재한다고 암묵적으로 가정할 것이다.</p>
<ul>
<li>definition의 경우가 존재한다고 가정한다..?</li>
</ul>
<p>The notion of self-consistency is not vacuous, as the two extreme cases demonstrate.</p>
<p>두 극단적인 경우에서 나타나는 듯이, self-consistency는 모호한 개념이 아니다.</p>
<p>The random vector <span class="math inline">\(\bf{X}\)</span> is self-consistent for <span class="math inline">\(\bf{X}\)</span> and represents no loss of information.</p>
<p>확률 벡터 X는 X에 대해 self-consistent 하며, information의 손실이 전혀 없다.</p>
<p><span class="math inline">\(\bf{Y} = \cal{E} [\bf{X}]\)</span> is also self-consistent for <span class="math inline">\(\bf{X}\)</span> and represents a total loss of information except for the location of the distribution.</p>
<p>Y=E(X)는 X에 대해 self-consistent 하며, 분포의 위치를 제외하고 information이 전체적으로 손실된다.</p>
<p>Interesting self-consistent distributions range in between these two extremes.</p>
<p>이 두 극단적인 경우 사이에 self-consistent 분포들이 있다.</p>
<p><code>1</code> <span class="math inline">\(\bf{X}\)</span>는 information 손실이 없지만, <span class="math inline">\(\bf{Y}=E(X)\)</span>는 <span class="math inline">\(\epsilon\)</span>을 잃어서 information 손실이 생긴다.</p>
<p><code>2</code> <span class="math inline">\(\bar{X}\)</span>는 information 손실이 없지만, <span class="math inline">\(\tilde{X} = E(\bar{X})\)</span>는 <span class="math inline">\(x_1\)</span>이 <span class="math inline">\(\mu\)</span>로 바뀌어 information 손실이 생긴다.</p>
<p>Many relevant cases of self-consistency are obtained by taking conditional means over subsets of the sample space of <span class="math inline">\(\bf{X}\)</span>.</p>
<p>self-consistency의 많은 관련된 경우는 집합 𝐗의 표본 공간의 부분집합에 대한 조건부 평균을 취함으로써 구해진다.</p>
<p>Another simple example of self-consistency is the following:</p>
<p>또다른 self-consistency의 단순한 예제이다.</p>
<p><span style="background-color:#9966FF"> <strong>EXAMPLE 2.1.</strong> </span> <em>Partial sums.</em> Let <span class="math inline">\(\{X_n\}\)</span> denote a sequence of independent, mean-zero random variables, and let <span class="math inline">\(S_n = \sum^n_{i=1} X_i\)</span>.</p>
<p>부분합, x_n을 독립이고, 평균이 0인 확률 변수라고 할 때, x의 합을 Sn이라 두자.</p>
<p>Then <span class="math inline">\(\cal{E}\)</span><span class="math inline">\([S_{n+k}|S_n] = S_n + \cal{E}\)</span><span class="math inline">\([X_{n+1} + \dots + X_{n+k}|S_n] = S_n + \cal{E}\)</span><span class="math inline">\([X_{n+1} + \dots + X_{n+k}] = S_n\)</span>.</p>
<p>그러면 이 식이 성립함.</p>
<p><code>-</code> 증명 <span class="math inline">\(\cal{E}\)</span><span class="math inline">\([S_{n+k}|S_n]=\)</span><span class="math inline">\(\cal{E}\)</span><span class="math inline">\([S_n + X_{n+1} + \dots + X_{n+k}|S_n]=\)</span><span class="math inline">\(\cal{E}\)</span><span class="math inline">\([X_{1} + \dots + X_n + X_{n+1} + \dots +X_{n+k}|S_n]=\)</span><span class="math inline">\(\cal{E}\)</span><span class="math inline">\([X_{n+1} + \dots + X_{n+k}] + S_n=S_n\)</span></p>
<p>Thus, <span class="math inline">\(S_n\)</span> is self-consistent for <span class="math inline">\(S_{n+k}, k &gt; 1\)</span>.</p>
<p>그려면 sn은 sn+k에 대해 self-consistent하다고 함.</p>
<p>The same property holds more generally if <span class="math inline">\(\{S_n\}_{n\ge1}\)</span> represents a martingale process.</p>
<p>만일 저 식이 마틴게일 프로세스를 나타낸다면 동일한 특성이 유지된다.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>martingale process 의 특징</p>
<ul>
<li>기댓값의 일정성</li>
<li>확률변수의 분포 고정</li>
</ul>
</div>
</div>
<p>For a given <span class="math inline">\(\bf{X}\)</span>, a self-consistent approximation <span class="math inline">\(\bf{Y}\)</span> can be generated by partitioning the sample space of <span class="math inline">\(\bf{X}\)</span> and defining <span class="math inline">\(\bf{Y}\)</span> as a random variable taking as values the conditional means, of subsets in the partition.</p>
<p>주어진 확률 변수 <span class="math inline">\(\bf{X}\)</span>에 대한 self-consistent approximation <span class="math inline">\(\bf{Y}\)</span>는 <span class="math inline">\(\bf{X}\)</span>의 표본 공간을 분할하여 각 분할된 부분집합에 대한 조건부 평균을 값으로 가지는 랜덤 변수로 정의될 수 있다.</p>
<p>This is illustrated by our next example, in which the support of <span class="math inline">\(\bf{X}\)</span> is partitioned into two half-planes.</p>
<p>다음 예제에서 확률 변수 <span class="math inline">\(\bf{X}\)</span>의 support(모든 값?)가 두 개의 반 평면으로 나뉜다.(x1&gt;0,x1&lt;=0인듯?)</p>
<p><span style="background-color:#9966FF"> <strong>EXAMPLE 2.2.</strong> </span> <em>Two principal points.</em> Let <span class="math inline">\(\bf{X} = (X_1, X_2)' \sim N_2(0, I_2)\)</span>. Note that <span class="math inline">\(\cal{E}\)</span><span class="math inline">\([X_1|X_1 \ge 0] = \sqrt{2/\pi}\)</span>. Let <span class="math inline">\(\bf{Y} = (-\sqrt{2/\pi}, 0)'\)</span> if <span class="math inline">\(X_1 &lt; 0\)</span> and <span class="math inline">\(\bf{Y} = (\sqrt{2/\pi}, 0)'\)</span> if <span class="math inline">\(X_1 &gt; 0\)</span>. Then <span class="math inline">\(\bf{Y}\)</span> is self-consistent for <span class="math inline">\(\bf{X}\)</span>.</p>
<p><span class="math inline">\(\bf{Y} = \begin{cases}(-\sqrt{\frac{2}{\pi}}, 0)' &amp; if X_1 &lt; 0 \\ (\sqrt{\frac{2}{\pi}}, 0)' &amp; if X_1 \ge 0 \end{cases}\)</span></p>
<p><span class="math inline">\(\cal{E}\)</span><span class="math inline">\([X_1|X_1 \ge 0] = \bf{Y} = \sqrt{\frac{2}{\pi}}\)</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(X_1 \sim U(0,1), X_2 \sim U(0,1)\)</span> <span class="math inline">\((X_1,X_2)\)</span>는 독립이라면, <span class="math inline">\(\cal{E}\)</span><span class="math inline">\([X_1|X_1 \ge 0.5] = 0.75\)</span></p>
<p><span class="math inline">\(Y = \begin{cases}(0.25, 0)' &amp; if X_1 &lt; 0.5 \\ (0.75, 0)' &amp; if X_1 \ge 0.5 \end{cases}\)</span></p>
<p><span class="math inline">\(Y\)</span>는 <span class="math inline">\(X_1\)</span>이 0.5보다 클때 0.75로, <span class="math inline">\(\cal{E}\)</span><span class="math inline">\([X_1|X_1 \ge 0.5]\)</span>와 같다. 따라서 <span class="math inline">\(Y\)</span>는 <span class="math inline">\(X\)</span>에 대해 self-consistent하다.</p>
</div>
</div>
<p>See Section 6 for a definition of principal points, and see Figure 7 for a generalization of this example.</p>
<div id="0385748b-bddb-4fcd-9f68-7027fef0e1bb" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_points_on_circle(k):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    theta <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">2</span><span class="op">*</span>np.pi, k, endpoint<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> np.cos(theta)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> np.sin(theta)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x, y</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_circle_points_subplot(k_values):</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    fig, axs <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">10</span>))</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    fig.suptitle(<span class="st">'Figure 7'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, k <span class="kw">in</span> <span class="bu">enumerate</span>(k_values, <span class="dv">1</span>):</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        x, y <span class="op">=</span> generate_points_on_circle(k)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>        ax <span class="op">=</span> axs[(i<span class="op">-</span><span class="dv">1</span>)<span class="op">//</span><span class="dv">3</span>, (i<span class="op">-</span><span class="dv">1</span>)<span class="op">%</span><span class="dv">3</span>]</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Plot the limiting circle</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>        theta_limiting <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">2</span><span class="op">*</span>np.pi, <span class="dv">1000</span>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>        x_limiting <span class="op">=</span> np.cos(theta_limiting)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>        y_limiting <span class="op">=</span> np.sin(theta_limiting)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>        ax.plot(x_limiting, y_limiting, linestyle<span class="op">=</span><span class="st">'--'</span>, color<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Plot points for current k value</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>        ax.scatter(x, y, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>        ax.set_title(<span class="ss">f'k=</span><span class="sc">{</span>k<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>        ax.set_xticks([])  <span class="co"># Remove x-axis ticks</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>        ax.set_yticks([])  <span class="co"># Remove y-axis ticks</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>        ax.legend().set_visible(<span class="va">False</span>)  <span class="co"># Remove legend</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>        ax.grid(<span class="va">False</span>)  <span class="co"># Remove grid lines</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>        ax.axis(<span class="st">'equal'</span>)  <span class="co"># Ensure equal scaling for X and Y axes</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout(rect<span class="op">=</span>[<span class="dv">0</span>, <span class="fl">0.03</span>, <span class="dv">1</span>, <span class="fl">0.95</span>])</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Set of k values</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>k_values <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">10</span>]</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the circles and points using subplot with removed legend, grid, and axis lines</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>plot_circle_points_subplot(k_values)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2024-02-05-Self-Consistency Review_files/figure-html/cell-3-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The preceding example illustrates the purpose of self-consistency quite well.</p>
<p>다음 예제는 self-consistency의 목적을 잘 나타낸다.</p>
<p>It is actually an application of our first lemma.</p>
<p>첫번째 lemma를 응용한 것이다.</p>
<p><span style="background-color:#E0CCEF"> <strong>Lemma 2.1.</strong> </span> <em>For a <span class="math inline">\(p\)</span>-variate random vector</em> <span class="math inline">\(\bf{X}\)</span>, <em>suppose</em> <span class="math inline">\(\mathcal{S} \subset \mathbb{R}^p\)</span> <em>is a measurable set such that</em> <span class="math inline">\(\forall \bf{y} \in \mathcal{S}, \bf{y} = \cal{E}[\bf{X} | \bf{X} \in \mathbb{D_y}]\)</span>, <em>where</em> <span class="math inline">\(\mathbb{D}_y\)</span> <em>is the domain of attraction of</em> <span class="math inline">\(\bf{y}\)</span>, <em>that is,</em> <span class="math inline">\(\mathbb{D}_y = \{\bf{x} \in \mathbb{R}^p: ||\bf{x} - \bf{y}|| &lt; ||\bf{x} - \bf{y}^*||, \forall \bf{y}^* \in \cal{s} \}\)</span>.</p>
<p>p변량 랜덤 벡터 X에 대해서 p차원의 실수 집합의 부분집합인 S가 측정 가능한 집합일때, y가 모두 S에 속하고, y에 수렴하는 도메인인 D에 X가 속하는 조건부 기댓값은 y와 같다.</p>
<p>x는 p차원의 실수집합에 속하고, p차원의 실수집합 p차원의 실수집합에 속하는 모든 y * 에 대해 x,y 의 거리가 x,y * 의 거리보다 짧다면, x는 Dy에 속한다.</p>
<p>Defne <span class="math inline">\(\bf{Y} = \bf{y}\)</span> if <span class="math inline">\(\bf{X} \in \mathbb{D}_y\)</span>: Then <span class="math inline">\(\bf{Y}\)</span> is self-consistent for <span class="math inline">\(\bf{X}\)</span>.</p>
<p>X가 y의 domain of attration에 속한다면, Y=y라고 정의하며, Y는 X에 대해 self-consistent 하다.</p>
<p><span style="background-color:#F5F1F8"> <strong>Proof.</strong> </span> <span class="math inline">\(\cal{E}\)</span><span class="math inline">\([\bf{X} | \bf{Y}=\bf{y}] =\)</span><span class="math inline">\(\cal{E}\)</span><span class="math inline">\([\bf{X}|\bf{X} \in \mathbb{D}_y] = \bf{y}\)</span>.</p>
<p>In Example 2.2, <span class="math inline">\(\cal{S}\)</span> consists of only two points, and the associated domains of attraction are the half-planes given by <span class="math inline">\(x_1 &lt; 0\)</span> and <span class="math inline">\(x_1 &gt; 0\)</span>.</p>
<p>예제 2.2에서 S는 두 점으로 구성되어 있고, associated domain of attraction은 x_1&lt;0이거나 x_1&gt;0인 half-plane이다.</p>
<p>The following three lemmas give elementary properties of self-consistent random vectors.</p>
<p>다음 세 개의 lemma는 self-consistent한 랜덤 벧터의 기본적인 특성을 제시한다.</p>
<p><span style="background-color:#E0CCEF"> <strong>Lemma 2.2.</strong> </span> If <span class="math inline">\(\bf{Y}\)</span> is self-consistent for <span class="math inline">\(\bf{X}\)</span>, then <span class="math inline">\(\cal{E}\)</span> <span class="math inline">\([\bf{Y}]=\)</span><span class="math inline">\(\cal{E}\)</span><span class="math inline">\([\bf{X}]\)</span>.</p>
<p>Y가 X에 대해 self-consistent하다면, Y의 기댓값은 X의 기댓값과 같다.</p>
<p><span style="background-color:#F5F1F8"> <strong>Proof.</strong> </span> The lemma follows from <span class="math inline">\(\cal{E}\)</span><span class="math inline">\([\cal{E}\)</span><span class="math inline">\([\bf{X}|\bf{Y}]]=\)</span><span class="math inline">\(\cal{E}\)</span><span class="math inline">\([\bf{X}]\)</span></p>
<p>We now introduce notation for the mean squared error (MSE) of a random vector <span class="math inline">\(\bf{Y}\)</span> for <span class="math inline">\(\bf{X}\)</span>,</p>
<p><span class="math inline">\(MSE(\bf{Y};\bf{X})=\cal{E}\)</span><span class="math inline">\(||\bf{X}-\bf{Y}||^2\)</span></p>
<p>The next lemma relates the MSE of a selfconsistent Y for X in terms of their respective covariance matrices.</p>
<p>다음 lemma는 X에 대해 self-consistent한 Y의 MSE와 관련있는데, 이를 공분산 행렬로 각각 나타낼 것이다.</p>
<p>Here, <span class="math inline">\(\Psi_\bf{X}\)</span> and <span class="math inline">\(\Psi_\bf{Y}\)</span> denote the covariance matrices of <span class="math inline">\(\bf{X}\)</span> and <span class="math inline">\(\bf{Y}\)</span>, respectively.</p>
<p>공분산 X,Y를 쓰는 법 각각</p>
<p><span style="background-color:#E0CCEF"> <strong>Lemma 2.3.</strong> </span> If <span class="math inline">\(\bf{Y}\)</span> is self-consistent for <span class="math inline">\(\bf{X}\)</span>, then the following hold: (i) <span class="math inline">\(\Psi_\bf{X} \ge \Psi_\bf{Y}\)</span>, that is, <span class="math inline">\(\Psi_{\bf{X}} - \Psi_{\bf{Y}}\)</span> is positive semidenite; (ii) <span class="math inline">\(MSE(\bf{Y};\bf{X})= tr(\Psi_{\bf{X}}) - tr(\Psi_\bf{Y})\)</span>:</p>
<p>Y가 X에 대해 self-consistent하다면, X의 공분산행렬은 Y의 공분산행렬보다 크다. MSE는 X의 공분상행렬의 대각행렬에서 Y의 공분산향렬의 대각행렬을 뺀 것과 같다.(X의 분산 - Y의 본산 과 같다.)</p>
<p>See the Appendix for a proof.</p>
<p><span style="background-color:#F5F05E"> <em>appendix</em> </span> Proof of Lemma 2.3. Without loss of generality assume <span class="math inline">\(\cal{E}\)</span><span class="math inline">\([\bf{X}] = 0\)</span>. For part (i), by self-consistency of <span class="math inline">\(\bf{Y}\)</span> for <span class="math inline">\(\bf{X}\)</span> and using the conditional variance formula <span class="math inline">\(Cov[\bf{X}] = Cov[\cal{E}\)</span><span class="math inline">\([\bf{X}|\bf{Y}]]+ \cal{E}\)</span><span class="math inline">\([Cov[\bf{X}|\bf{Y}]]\)</span>, we have <span class="math inline">\(Cov[\bf{X}] =\)</span><span class="math inline">\(Cov[\bf{Y}] + \cal{E}\)</span><span class="math inline">\([Cov[\bf{X}|\bf{Y}]]\)</span>. But <span class="math inline">\(Cov[\bf{X}|\bf{Y}]\)</span> is positive semidefinite almost surely, and hence (i) follows. For part (ii) we have</p>
<p><span class="math inline">\(\cal{E}\)</span><span class="math inline">\(||\bf{X}-\bf{Y}||^2 =\)</span> <span class="math inline">\(\cal{E}\)</span><span class="math inline">\([\bf{X}'\bf{X}] -\)</span> <span class="math inline">\(2\cal{E}\)</span><span class="math inline">\([\bf{Y'X}] +\)</span> <span class="math inline">\(\cal{E}\)</span><span class="math inline">\([\bf{Y'Y}]\)</span></p>
<p><span class="math inline">\(= tr(\Psi_\bf{X})-\)</span> <span class="math inline">\(2\cal{E}[\cal{E}\)</span><span class="math inline">\([\bf{Y'X|Y}]]+\)</span> <span class="math inline">\(tr(\Psi_\bf{Y})\)</span>.</p>
<p><span class="math inline">\(= tr(\Psi_\bf{X})-\)</span> <span class="math inline">\(2\cal{E}\)</span><span class="math inline">\([\bf{Y'}\cal{E}\)</span><span class="math inline">\([\bf{X|Y}]]+\)</span> <span class="math inline">\(tr(\Psi_\bf{Y})\)</span>.</p>
<p><span class="math inline">\(= tr(\Psi_\bf{X})-\)</span> <span class="math inline">\(2\cal{E}\)</span><span class="math inline">\([\bf{Y'Y}]+\)</span> <span class="math inline">\(tr(\Psi_\bf{Y})\)</span>.</p>
<p><span class="math inline">\(= tr(\Psi_\bf{X})-\)</span><span class="math inline">\(tr(\Psi_\bf{Y})\)</span>.</p>
<p><em>다시 써보기</em></p>
<p><span class="math inline">\(E||X - Y||^2 = E(XX' - X'Y - Y'X + YY')\)</span></p>
<p><span class="math inline">\(= E(X^2 - 2Y'X + Y^2)\)</span></p>
<p><span class="math inline">\(= tr(\Psi_X) - 2 E(E(Y'X|Y)) + tr(\Psi_Y)\)</span></p>
<p><span class="math inline">\(= tr(\Psi_X) - 2 E(Y'E(X|Y)) + tr(\Psi_Y)\)</span></p>
<p><span class="math inline">\(= tr(\Psi_X) - 2 E(Y'Y) + tr(\Psi_Y)\)</span></p>
<p><span class="math inline">\(= tr(\Psi_X) - 2tr(\Psi_Y) + tr(\Psi_Y)\)</span></p>
<p><span class="math inline">\(= tr(\Psi_X) - tr(\Psi_Y)\)</span></p>
<p><code>-</code> <span class="math inline">\(E(Y'X) = E(E(Y'X|Y))\)</span> <span class="math inline">\(\to\)</span> 전체 기댓값의 법칙</p>
<div class="callout callout-style-default callout-note callout-titled" title="전체 기댓값의 법칙 증명(이산확률변수에서)">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
전체 기댓값의 법칙 증명(이산확률변수에서)
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(E(E(X|Y)) = E(X)\)</span> 일때,</p>
<p><span class="math inline">\(E(E(X|Y))\)</span></p>
<p><span class="math inline">\(= \sum_{y \in Y} p(y)E(X|Y)\)</span></p>
<p><span class="math inline">\(= \sum_{y \in Y} p(y) \sum_{x \in X} p(x|y) x\)</span></p>
<p><span class="math inline">\(= \sum_{y \in Y} \sum_{x \in X} p(y) p(x|y) x\)</span></p>
<p><span class="math inline">\(= \sum_{y \in Y} \sum_{x \in X} p(x,y) x\)</span></p>
<p><span class="math inline">\(= \sum_{x \in X} p(x) x = E(X)\)</span></p>
</div>
</div>
<p>It follows from Lemma 2.3 that <span class="math inline">\(Cov[\bf{Y}] =\)</span><span class="math inline">\(Cov[\bf{X}]\)</span> exactly if <span class="math inline">\(Cov[\bf{X}|\bf{Y}] = 0\)</span> a.s., that is, if <span class="math inline">\(\bf{Y} = \bf{X}\)</span> a.s.</p>
<p>lemma 2.3의 <span class="math inline">\(Cov[\bf{X}] = Cov[\cal{E}\)</span><span class="math inline">\([\bf{X}|\bf{Y}]]+ \cal{E}\)</span><span class="math inline">\([Cov[\bf{X}|\bf{Y}]]\)</span> 여기서 <span class="math inline">\(Cov[\bf{X}|\bf{Y}]\)</span>이 0이 된다면,</p>
<p><span class="math inline">\(Cov[\bf{X}] = Cov[\cal{E}\)</span><span class="math inline">\([\bf{X}|\bf{Y}]]\)</span>, 근데 Y가 X에 대해 self-consistent할 때 <span class="math inline">\(\cal{E}\)</span><span class="math inline">\([\bf{X}|\bf{Y}] = Y\)</span>,</p>
<p>따라서 <span class="math inline">\(Cov[\bf{X}] = Cov[Y]\)</span></p>
<p>For one-dimensional random variables <span class="math inline">\(\bf{X}\)</span> and <span class="math inline">\(\bf{Y}\)</span>, if <span class="math inline">\(\bf{Y}\)</span> is self-consistent for <span class="math inline">\(\bf{X}\)</span>, then <span class="math inline">\(var[\bf{Y}]\)</span> <span class="math inline">\(\le var[\bf{X}]\)</span>, with equality exactly if <span class="math inline">\(\bf{Y}\)</span><span class="math inline">\(=\bf{X}\)</span> a.s.</p>
<p>There is a similarity between the two preceding lemmas and the Rao{Blackwell theorem (Casella and Berger, 1990, page 316), which in a simplied version states the following.</p>
<p>If <span class="math inline">\(\bf{X}\)</span> is an unbiased estimator of a parameter <span class="math inline">\(\theta\)</span>, and if <span class="math inline">\(\bf{Y}\)</span> is a sufcient statistic for <span class="math inline">\(\theta\)</span>, then <span class="math inline">\(\cal{E}\)</span><span class="math inline">\([\bf{X}|\bf{Y}]\)</span> is an unbiased estimator of <span class="math inline">\(\theta\)</span>, and <span class="math inline">\(var[\cal{E}\)</span><span class="math inline">\([\bf{X}|\bf{Y}]\)</span><span class="math inline">\(\le var[\bf{X}]\)</span>. If <span class="math inline">\(\cal{E}\)</span><span class="math inline">\([\bf{X}|\bf{Y}\)</span><span class="math inline">\(] = \bf{Y}\)</span>, then Lemma 2.2 gives <span class="math inline">\(\cal{E}\)</span><span class="math inline">\([\bf{Y}\)</span><span class="math inline">\(] = \cal{E}\)</span><span class="math inline">\([\bf{X}]\)</span>, and part (i) of Lemma 2.3 gives <span class="math inline">\(var[\bf{Y}]\le var[\bf{X}]\)</span>.</p>
<ol type="1">
<li>만일 X가 세타에 대한 비편향 추정량이고(<span class="math inline">\(E(X)=\theta,X=\hat{\theta}\)</span>,X의 기댓값이 세타와 같다면),</li>
<li>만일 Y가 세타에 대한 충분 통계량이라면(Y가 세타에 대한 충분한 정보가 있어서 세타를 효율적으로 표현할 수 있다면)</li>
</ol>
<ul>
<li>Y가 주어졌을때 X의 기댓값은 세타에 대한 비편향 추정량이고(Y가 주어졌을때 X의 기댓값이 세타와 같고),</li>
<li>Y가 주어졌을때 X의 기댓값의 분산은 X의 분산보다 작거나 같다. <span class="math inline">\(\to\)</span> 그럼 상대효율 따지면 <span class="math inline">\(\frac{var[\cal{E} [\bf{X}|\bf{Y}]}{var[\bf{X}]} \le 1\)</span>가 되어서 E(X|Y)가 X보다 효율적이라는 말인데..</li>
</ul>
<p><code>-</code> 만일 Y가 주어졌을때 X의 기댓값이 Y라면(Y가 X에 대해 self-consistent 하다면)</p>
<ul>
<li>lemma 2.2에서 X의 기댓값이 Y의 기댓값과 같다고 할 수 있고,</li>
<li>lemma 2.3에서 Y의 분산이 X의 분산보다 작거나 같다고 할 수 있다.</li>
</ul>
<p>The next lemma demonstrates a dimensionality reducing property of self-consistent random variables.</p>
<p>다음 lemma는 self-consistent 확률 변수의 차원적으로 감소하는 특징에 대해 설명한다.</p>
<p>Here, <span class="math inline">\(\cal{S}\)</span><span class="math inline">\((\bf{Y})\)</span> denotes the support of <span class="math inline">\(\bf{Y}\)</span>.</p>
<p>S(Y)는 Y의 support를 의미</p>
<blockquote class="blockquote">
<p>Y의 support = Y의 집합?</p>
</blockquote>
<p><span style="background-color:#E0CCEF"> <strong>Lemma 2.4.</strong> </span> Suppose <span class="math inline">\(\bf{Y}\)</span> is self-consistent for a <span class="math inline">\(p\)</span>-variate random vector <span class="math inline">\(\bf{X}\)</span> with <span class="math inline">\(\cal{E}\)</span><span class="math inline">\([\bf{X}] = 0\)</span>, and <span class="math inline">\(\cal{S}\)</span><span class="math inline">\((\bf{Y})\)</span> is contained in a linear subspace spanned by <span class="math inline">\(q\)</span> orthonormal column vectors in the <span class="math inline">\(p \times q\)</span> matrix A.</p>
<p>X의 기댓값이 0일때, Y를 p 변량 확률 벡터 X에 대해 self-consistent 하다고 가정하면, S(Y) 는 p행 q열 행렬 A에서 q열이 직교한 벡터는 생성된 선형 부분 공간에 포함된다.</p>
<p>Let <span class="math inline">\(P = AA'\)</span> denote the associated projection matrix.</p>
<p>Then <span class="math inline">\(\bf{Y}\)</span> and <span class="math inline">\(\bf{A'Y}\)</span> are self-consistent for <span class="math inline">\(\bf{PX}\)</span> and <span class="math inline">\(\bf{A'X}\)</span>, respectively.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Projection Matrix 투영행렬">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Projection Matrix 투영행렬
</div>
</div>
<div class="callout-body-container callout-body">
<p>투영행렬의 특징</p>
<ul>
<li><span class="math inline">\(P\)</span>는 대칭 행렬</li>
<li><span class="math inline">\(P^2 = P\)</span></li>
</ul>
</div>
</div>
<p>See the Appendix for a proof.</p>
<p><span style="background-color:#F5F05E"> <em>appendix</em> </span> Proof of Lemma 2.4. Since <span class="math inline">\(\bf{Y}\)</span> is self-consistent for <span class="math inline">\(\bf{X}\)</span>, <span class="math inline">\(\cal{E}\)</span><span class="math inline">\([\bf{PX|Y}] = \bf{P}\cal{E}\)</span><span class="math inline">\([\bf{X|Y}] = \bf{PY} = \bf{Y}\)</span> a.s.</p>
<p>For a given <span class="math inline">\(\bf{y} \in \mathbb{R}^p\)</span>, let <span class="math inline">\(\bf{w = A^{'}_{1} y}\)</span>.</p>
<p>Then <span class="math inline">\(\{ \bf{Y} = \bf{y} \} = \{A^{'}_{1} Y = w\}\)</span>.</p>
<p>Multiplying both sides of the equation <span class="math inline">\(\cal{E}\)</span><span class="math inline">\([\bf{X|Y = y] = y}\)</span> on the left by <span class="math inline">\(A^{'}_{1}\)</span> gives <span class="math inline">\(\cal{E}\)</span><span class="math inline">\([\bf{A^{'}_{1} X|A^{'}_{1} Y} = w] = w\)</span>.</p>
<p>Lemma 2.4 means that the marginal distribution of a self-consistent <span class="math inline">\(\bf{Y}\)</span> in the linear subspace spanned by its support is self-consistent for the marginal distribution of <span class="math inline">\(\bf{X}\)</span> in the same subspace.</p>
<p>lemma 2.4가 의미하는 것은 그 support에 의해 생성된 선형 부분공간에서 self-consistent한 Y의 주변 분포는 같은 부분공간에서 X의 주변 분포에 대해 self-consistent한 것이다.</p>
<p>For example, a self-consistent distribution for <span class="math inline">\(\bf{X}\)</span> whose support consists of a circle (see Section 6) is determined by the bivariate marginal distribution of <span class="math inline">\(\bf{X}\)</span> in the subspace containing the circle.</p>
<p>예를 들어, support가 원으로 구성된 X에 대해 self-consistent한 분포는 원을 포함한 부분 공간에서 X의 이변량 주변 분포에 의해 결정된다.</p>
<p>In Example 2.2, the linear subspace spanned by the support of <span class="math inline">\(\bf{Y}\)</span> is the <span class="math inline">\(x_1\)</span>-axis, the marginal distribution of <span class="math inline">\(\bf{X}\)</span> in this subspace is standard normal, and the random variable <span class="math inline">\(\bf{Y}_1 = sgn(\bf{X}_1)\sqrt{2/\pi}\)</span> is self-consistent for <span class="math inline">\(\bf{X}_1\)</span>.</p>
<p>예제 2.2에서 Y의 support에 의해 생성된 선형 부분 공간은 x1축이고, 부분 공간에서 X의 주변 분포는 표준정규분포이고, X1의 값에 따라 바꿔는 확률변수 Y1은 X1에 대해 self-consistent하다.</p>
<p>We conclude this section with a general method of finding self-consistent random variables.</p>
<p><span style="background-color:#E0CCEF"> <strong>Lemma 2.5.</strong> </span> Let <span class="math inline">\(\bf{X}\)</span> and <span class="math inline">\(\bf{Y}\)</span> denote two jointly distributed random vectors, not necessarily of the same dimension.</p>
<p>Then <span class="math inline">\(\cal{E}\)</span><span class="math inline">\([\bf{X}|\bf{Y}]\)</span> is self-consistent for <span class="math inline">\(\bf{X}\)</span>.</p>
<p><span style="background-color:#F5F1F8"> <strong>Proof.</strong> </span> Let <span class="math inline">\(\bf{Z} = \cal{E}\)</span><span class="math inline">\([\bf{X}|\bf{Y}]\)</span>. Then <span class="math inline">\(\cal{E}\)</span><span class="math inline">\([\bf{X}|\bf{Z}] = \cal{E}[\cal{E}\)</span><span class="math inline">\([\bf{X}|\bf{Y}]|\bf{Z}] = \cal{E}[\bf{Z}|\bf{Z}] =\bf{Z}\)</span></p>
<p>In particular, setting <span class="math inline">\(\bf{Y} = \bf{X}\)</span> in Lemma 2.5 gives again self-consistency of <span class="math inline">\(\bf{X}\)</span> for itself.</p>
<p>If <span class="math inline">\(\bf{Y}\)</span> is independent of <span class="math inline">\(\bf{X}\)</span>, then it follows that <span class="math inline">\(\cal{E}\)</span><span class="math inline">\([\bf{X}]\)</span> is self-consistent for <span class="math inline">\(\bf{X}\)</span>.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="seoyeonc/sy_hub" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->




</body></html>