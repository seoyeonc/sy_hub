<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.315">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="SEOYEON CHOI">
<meta name="dcterms.date" content="2023-05-18">

<title>Seoyeon’s Blog - EbayesThresh Toy ex</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Seoyeon’s Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://seoyeonc.github.io/md/"> 
<span class="menu-text">Lectures</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://seoyeonc.github.io/chch/"> 
<span class="menu-text">Lectures_fastai</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://seoyeonc.github.io/blog/"> 
<span class="menu-text">Research_ing</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://seoyeonc.github.io/ms/"> 
<span class="menu-text">Research_fastai</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/seoyeonc"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">EbayesThresh Toy ex</li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">EbayesThresh Toy ex</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Ebayesthresh</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>SEOYEON CHOI </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">May 18, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../1_note.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Note</strong></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text"><strong>Studies</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2_graph.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Graph</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2_quantum.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quantum</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2_pyg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pyg</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text"><strong>Researches</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../3_ittgnn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ITTGNN</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../3_gode.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GODE</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#import" id="toc-import" class="nav-link active" data-scroll-target="#import">Import</a></li>
  <li><a href="#bayesian-model" id="toc-bayesian-model" class="nav-link" data-scroll-target="#bayesian-model">Bayesian Model</a></li>
  <li><a href="#ebayesthresh" id="toc-ebayesthresh" class="nav-link" data-scroll-target="#ebayesthresh">EbayesThresh</a></li>
  <li><a href="#result" id="toc-result" class="nav-link" data-scroll-target="#result">Result</a></li>
  <li><a href="#in-article" id="toc-in-article" class="nav-link" data-scroll-target="#in-article">In article</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="2023-05-20-EbayesThresh toy ex.out.ipynb" download="2023-05-20-EbayesThresh toy ex.out.ipynb"><i class="bi bi-journal-code"></i>Jupyter</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">




<section id="import" class="level1 page-columns page-full">
<h1>Import</h1>
<div id="53ebc58c-89f2-47dc-a9a8-fc100d15f23f" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itstgcn.learners <span class="im">import</span> <span class="op">*</span> </span></code></pre></div>
</div>
<div id="c8c0e86b-71e1-46c0-b73b-7e138b3df844" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code></pre></div>
</div>
<div id="03a2d082-c166-4df0-a1dc-dad5e323e79c" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rpy2.robjects.vectors <span class="im">import</span> FloatVector</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> rpy2.robjects <span class="im">as</span> robjects</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rpy2.robjects.packages <span class="im">import</span> importr</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> rpy2.robjects.numpy2ri <span class="im">as</span> rpyn</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>ebayesthresh <span class="op">=</span> importr(<span class="st">'EbayesThresh'</span>).ebayesthresh</span></code></pre></div>
</div>
<ul>
<li><p>While <span class="math inline">\({\bf p}_y\)</span> serves as a consistent estimator for <span class="math inline">\(\mathbb{E}[|{\bf V}^H{\bf y}|^2]\)</span>, it is not an efficient estimator, and therefore, improvement is needed <span class="citation" data-cites="djuric2018cooperative">(<a href="#ref-djuric2018cooperative" role="doc-biblioref">Djuric and Richard 2018</a>)</span>. The traditional approach for improvement is to use the windowed periodogram.</p></li>
<li><p>The windowed periodogram is efficient in detecting specific frequencies or periods, but it may not be as efficient in estimating the underlying function. One notable paper that utilized the windowed periodogram is the one that detected the El Niño phenomenon.</p></li>
<li><p>As this structure exhibits a “sparse signal + heavy-tailed” characteristics, by applying Bayesian modeling and thresholding <span class="math inline">\({\bf p}_y\)</span>, we can estimate an appropriate <span class="math inline">\({\bf p}_{pp}\)</span> as discussed in <span class="citation" data-cites="johnstone2004needles">(<a href="#ref-johnstone2004needles" role="doc-biblioref">Johnstone and Silverman 2004</a>)</span>.</p></li>
</ul>
<div class="no-row-height column-margin column-container"><div id="ref-djuric2018cooperative" class="csl-entry" role="listitem">
Djuric, Petar, and Cédric Richard. 2018. <em>Cooperative and Graph Signal Processing: Principles and Applications</em>. Academic Press.
</div><div id="ref-johnstone2004needles" class="csl-entry" role="listitem">
Johnstone, Iain M, and Bernard W Silverman. 2004. <span>“Needles and Straw in Haystacks: Empirical Bayes Estimates of Possibly Sparse Sequences.”</span>
</div></div></section>
<section id="bayesian-model" class="level1 page-columns page-full">
<h1>Bayesian Model</h1>
<p><span class="math inline">\(x_i \sim N(\mu_i,1)\)</span></p>
<p><a href="https://guebin.github.io/AP2023/posts/II.%20%ED%99%95%EB%A5%A0%EB%A1%A0%EA%B8%B0%EC%B4%88/2023-05-02-09wk.html">확률변수</a>가 잘 정의되어 있을때, 여기서 <span class="math inline">\(\mu_i\)</span>를 정하는 Baysian.</p>
<ul>
<li><span class="math inline">\(\mu_i \sim\)</span> 사전분포(<span class="math inline">\(\mu_i\)</span>를 뽑을 수 있는)</li>
<li><span class="math inline">\((\mu_i | X_i = x_i)^n_{i=1} \sim\)</span> 사후분포</li>
</ul>
<p>ex) <span class="math inline">\(N(10,1) \sim\)</span> 사전분포</p>
<p>관측치</p>
<div id="e2c73fb2-5c49-4ddc-9733-6d7441c96373" class="cell" data-execution_count="454">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>_obs <span class="op">=</span> [<span class="fl">7.1</span>,<span class="fl">6.9</span>,<span class="fl">8.5</span>]</span></code></pre></div>
</div>
<div id="0f78eb0b-412a-4402-bf84-d655fcc79d0c" class="cell" data-execution_count="457">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>np.mean(_obs)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="457">
<pre><code>7.5</code></pre>
</div>
</div>
<p>관측치를 보니 평균이 10이 아닌 것 같다.</p>
<p><span class="math inline">\(N(10-3,1) \sim\)</span> 사후분포</p>
<ul>
<li>여기서, <span class="math inline">\(10-3\)</span>이 posterior meman</li>
<li>사후 분포를 정의할때, 이벤트의 mean이냐, median이냐로 잡는 방법은 정해진 것이 아니다.(이베이즈에서는 median으로 잡음)</li>
</ul>
<p>Ebayes는 사전분포를 Heavy-tail으로 정의했다.</p>
<p><strong>heavy tail?</strong></p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="2023-05-20-EbayesThresh toy ex_files/figure-html/ae7604a7-3ffd-4374-8640-097dfc92061c-1-9c4b08eb-c3d0-4414-960e-f5a50b79799f.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption margin-caption">image.png</figcaption>
</figure>
</div>
<p><span class="math inline">\(\mu_x \sim\)</span> Double Exponential <span class="math inline">\(= p_{pp} + p_{ac}\)</span> -&gt; 혼합형(misture) = pure point + absolutely continuous</p>
<p><span class="math inline">\(E(\mu_i | X_i = x_i) = \hat{\mu}_i\)</span> -&gt; thresholding의 결과</p>
<p><span class="math inline">\(f_{prior}(\mu) = (1-w)\delta_0(\mu) + w \gamma (\mu)\)</span></p>
<ul>
<li><span class="math inline">\(\delta_0\)</span> = <a href="https://guebin.github.io/AP2023/posts/II.%20%ED%99%95%EB%A5%A0%EB%A1%A0%EA%B8%B0%EC%B4%88/2023-06-06-14wk.html#%EC%9D%B4%EC%82%B0%ED%99%95%EB%A5%A0%EB%B3%80%EC%88%98">디렉함수(특정값이 아니면 다 0으로 봄)</a></li>
<li><span class="math inline">\(\gamma = \frac{a}{2} e^{-a|\mu|}\)</span></li>
</ul>
<p><strong>Ebayes의 역할 = 자동으로 <span class="math inline">\(w\)</span>를 계산 혹은 추정</strong></p>
<ul>
<li><span class="math inline">\(1-w\)</span> 확률로 <span class="math inline">\(\delta_0\)</span>를 정의, <span class="math inline">\(w\)</span>의 확룔로 <span class="math inline">\(\gamma\)</span>를 정의.</li>
</ul>
<p><span class="math inline">\(X_i = \mu_i + \epsilon_i, \epsilon_i \sim N(0,1)\)</span>에서 <span class="math inline">\(\mu_i\)</span>를 찾는게 목적이다. 이게 바로 <span class="math inline">\(\eta\)</span>값</p>
<ol type="1">
<li>Ebayes로 sparse signal만 골러낼 것이다.</li>
<li>평균 이상의 값에서 자를 것이다.
<ul>
<li>thresh(임계치)를 잡는 게 어려울 텐데, 위에서 이베이즈가 <span class="math inline">\(w\)</span>를 자동으로 잡아 확률 계산되는 방법론을 제안한 것,</li>
</ul></li>
<li>baysian modeling 사용하여 heavy tail + impulse(sparse)에서 posterior median 추정하여 임계값thresh으로 <span class="math inline">\(p\)</span>에서 <span class="math inline">\(p_{pp}\)</span>를 추출하는 것이 GODE 목적</li>
</ol>
</section>
<section id="ebayesthresh" class="level1">
<h1>EbayesThresh</h1>
<div id="e5c5fa94-8240-436a-be0d-8c1aba95dd1c" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> <span class="dv">100</span></span></code></pre></div>
</div>
<div id="02d38588-468b-43af-9045-f5ac953e542f" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.arange(T)<span class="op">/</span>T <span class="op">*</span> <span class="dv">10</span></span></code></pre></div>
</div>
<div id="bbd47ca4-ae94-4fe4-affc-14770eefd5fc" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>y_true <span class="op">=</span> <span class="dv">3</span><span class="op">*</span>np.sin(<span class="fl">0.5</span><span class="op">*</span>t) <span class="op">+</span> <span class="fl">1.2</span><span class="op">*</span>np.sin(<span class="fl">1.0</span><span class="op">*</span>t) <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span>np.sin(<span class="fl">1.2</span><span class="op">*</span>t) </span></code></pre></div>
</div>
<div id="ddd08a3d-4792-4c0e-8606-869b9127332d" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> y_true <span class="op">+</span> np.random.normal(size<span class="op">=</span>T)</span></code></pre></div>
</div>
<div id="e3fd906c-73a1-4890-8bd3-f686ebd1830c" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">6</span>))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>plt.plot(t,y_true)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-20-EbayesThresh toy ex_files/figure-html/cell-11-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><code>-</code> 관찰한 신호</p>
<div id="5a63ced7-d06a-4ae1-a9fb-6d6d4dc641f1" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>plt.plot(t,y,<span class="st">'o'</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>plt.plot(t,y_true,<span class="st">'--'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-20-EbayesThresh toy ex_files/figure-html/cell-12-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><code>-</code> 퓨리에 변환</p>
<div id="2a449208-c012-4626-abd2-9bce22bc1c90" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> np.array(y)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">len</span>(f.shape)<span class="op">==</span><span class="dv">1</span>: f <span class="op">=</span> f.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>T,N <span class="op">=</span> f.shape</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>Psi <span class="op">=</span> make_Psi(T)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>fbar <span class="op">=</span> Psi.T <span class="op">@</span> f <span class="co"># apply dft </span></span></code></pre></div>
</div>
<div id="894e4e22-80dc-4d23-9a68-7de6d211c77e" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>plt.plot(t,fbar<span class="op">**</span><span class="dv">2</span>) <span class="co"># periodogram </span></span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-20-EbayesThresh toy ex_files/figure-html/cell-14-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><code>-</code> threshed</p>
<div id="7ffb624e-77ab-4c58-bbf0-d631c4b9f375" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>fbar_threshed <span class="op">=</span> np.stack([ebayesthresh(FloatVector(fbar[:,i])) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N)],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>plt.plot((fbar<span class="op">**</span><span class="dv">2</span>)) <span class="co"># periodogram </span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>plt.plot((fbar_threshed<span class="op">**</span><span class="dv">2</span>)) </span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-20-EbayesThresh toy ex_files/figure-html/cell-15-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="8a4b57da-0121-43ee-bd8f-ae3726757b91" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>plt.plot((fbar<span class="op">**</span><span class="dv">2</span>)[<span class="dv">20</span>:<span class="dv">80</span>]) <span class="co"># periodogram </span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>plt.plot((fbar_threshed<span class="op">**</span><span class="dv">2</span>)[<span class="dv">20</span>:<span class="dv">80</span>]) </span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-20-EbayesThresh toy ex_files/figure-html/cell-16-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><code>-</code> 역퓨리에변환</p>
<div id="9b6a86a0-ad50-4b5f-b904-8100c6cb56d3" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>yhat <span class="op">=</span> Psi <span class="op">@</span> fbar_threshed <span class="co"># inverse dft</span></span></code></pre></div>
</div>
<div id="029d3cc1-1b90-4aed-83df-deade34f01bf" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">6</span>))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>plt.plot(t,y,<span class="st">'.'</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>plt.plot(t,y_true,<span class="st">'--'</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>plt.plot(t,yhat)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-20-EbayesThresh toy ex_files/figure-html/cell-18-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="4434b135-080e-450f-9f16-ab6d668e4c86" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">6</span>))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>plt.plot(y,<span class="st">'.'</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>plt.plot(y_true)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-20-EbayesThresh toy ex_files/figure-html/cell-19-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="result" class="level1">
<h1>Result</h1>
<div id="e9f6ebe7-9165-4e23-944a-3082d8b0050e" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> plt.style.context(<span class="st">'seaborn-white'</span>):</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    fig, ((ax1,ax2),(ax3,ax4)) <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">2</span>,figsize<span class="op">=</span>(<span class="dv">40</span>,<span class="dv">15</span>))</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    fig.suptitle(<span class="st">'Figure 1'</span>,fontsize<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    ax1.plot(y, <span class="st">'b.'</span>,alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    ax1.plot(y_true,<span class="st">'p--'</span>,label<span class="op">=</span><span class="st">'True'</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    ax1.legend(fontsize<span class="op">=</span><span class="dv">20</span>,loc<span class="op">=</span><span class="st">'upper left'</span>,facecolor<span class="op">=</span><span class="st">'white'</span>, frameon<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    ax1.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, labelsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    ax1.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, labelsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    ax2.plot(y, <span class="st">'b.'</span>,alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    ax2.plot(y_true,<span class="st">'p--'</span>,label<span class="op">=</span><span class="st">'True'</span>)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    ax2.plot(yhat,label<span class="op">=</span><span class="st">'y hat'</span>)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    ax2.legend(fontsize<span class="op">=</span><span class="dv">20</span>,loc<span class="op">=</span><span class="st">'upper left'</span>,facecolor<span class="op">=</span><span class="st">'white'</span>, frameon<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    ax2.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, labelsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    ax2.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, labelsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    ax3.plot((fbar<span class="op">**</span><span class="dv">2</span>)) <span class="co"># periodogram </span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    ax3.plot((fbar_threshed<span class="op">**</span><span class="dv">2</span>)) </span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    ax3.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, labelsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    ax3.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, labelsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>    ax3.axvspan(<span class="dv">20</span>, <span class="dv">80</span>, facecolor<span class="op">=</span><span class="st">'gray'</span>, alpha<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>    ax4.plot(<span class="bu">range</span>(<span class="dv">20</span>, <span class="dv">80</span>),(fbar<span class="op">**</span><span class="dv">2</span>)[<span class="dv">20</span>:<span class="dv">80</span>]) <span class="co"># periodogram </span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>    ax4.plot(<span class="bu">range</span>(<span class="dv">20</span>, <span class="dv">80</span>),(fbar_threshed<span class="op">**</span><span class="dv">2</span>)[<span class="dv">20</span>:<span class="dv">80</span>]) </span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>    ax4.set_xticks(<span class="bu">range</span>(<span class="dv">20</span>, <span class="dv">81</span>, <span class="dv">10</span>))</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>    ax4.set_xticklabels(<span class="bu">range</span>(<span class="dv">20</span>, <span class="dv">81</span>, <span class="dv">10</span>))</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ax4.set_xticklabels(['20','40','60'])</span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>    ax4.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, labelsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>    ax4.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, labelsize<span class="op">=</span><span class="dv">20</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-20-EbayesThresh toy ex_files/figure-html/cell-20-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="de103a14-098f-49be-833b-cd425b30f957" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mpl_toolkits.axes_grid1.inset_locator <span class="im">import</span> mark_inset, inset_axes</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">20</span>,<span class="dv">10</span>))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">'Figure'</span>,fontsize<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.subplot(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>ax.plot(<span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">100</span>),(fbar<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>ax.plot((fbar_threshed<span class="op">**</span><span class="dv">2</span>)) </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>axins <span class="op">=</span> inset_axes(ax, <span class="dv">8</span>, <span class="dv">3</span>, loc <span class="op">=</span> <span class="dv">1</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">0.8</span>, <span class="fl">0.8</span>),</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>                   bbox_transform <span class="op">=</span> ax.figure.transFigure)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>axins.plot(<span class="bu">range</span>(<span class="dv">20</span>, <span class="dv">80</span>),(fbar<span class="op">**</span><span class="dv">2</span>)[<span class="dv">20</span>:<span class="dv">80</span>])</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>axins.plot(<span class="bu">range</span>(<span class="dv">20</span>, <span class="dv">80</span>),(fbar_threshed<span class="op">**</span><span class="dv">2</span>)[<span class="dv">20</span>:<span class="dv">80</span>]) </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>axins.set_xlim(<span class="dv">20</span>, <span class="dv">80</span>)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>axins.set_ylim(<span class="op">-</span><span class="fl">0.1</span>, <span class="dv">7</span>)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>mark_inset(ax, axins, loc1<span class="op">=</span><span class="dv">4</span>, loc2<span class="op">=</span><span class="dv">3</span>, fc<span class="op">=</span><span class="st">"none"</span>, ec <span class="op">=</span> <span class="st">"0.01"</span>)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>ax.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, labelsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>ax.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, labelsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>axins.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, labelsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>axins.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, labelsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.savefig('Ebayes_Toy.png')</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-20-EbayesThresh toy ex_files/figure-html/cell-21-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="378a8ba8-ce36-4a5c-adb0-8d867c4d3f12" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.patches <span class="im">import</span> ConnectionPatch</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>,<span class="dv">10</span>))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">'Figure 1'</span>,fontsize<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>plot1 <span class="op">=</span> fig.add_subplot(<span class="dv">2</span>,<span class="dv">2</span>,(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>plot1.plot(<span class="bu">range</span>(<span class="dv">20</span>, <span class="dv">80</span>),(fbar<span class="op">**</span><span class="dv">2</span>)[<span class="dv">20</span>:<span class="dv">80</span>]) <span class="co"># periodogram </span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>plot1.plot(<span class="bu">range</span>(<span class="dv">20</span>, <span class="dv">80</span>),(fbar_threshed<span class="op">**</span><span class="dv">2</span>)[<span class="dv">20</span>:<span class="dv">80</span>]) </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>plot1.set_xticks(<span class="bu">range</span>(<span class="dv">20</span>, <span class="dv">81</span>, <span class="dv">10</span>))</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>plot1.set_xticklabels(<span class="bu">range</span>(<span class="dv">20</span>, <span class="dv">81</span>, <span class="dv">10</span>))</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>plot1.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, labelsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>plot1.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, labelsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>plot3 <span class="op">=</span> fig.add_subplot(<span class="dv">2</span>,<span class="dv">2</span>,(<span class="dv">3</span>,<span class="dv">4</span>)) </span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>plot3.plot((fbar<span class="op">**</span><span class="dv">2</span>)) <span class="co"># periodogram </span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>plot3.plot((fbar_threshed<span class="op">**</span><span class="dv">2</span>)) </span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>plot3.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, labelsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>plot3.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, labelsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>plot3.axvspan(<span class="dv">20</span>, <span class="dv">80</span>, facecolor<span class="op">=</span><span class="st">'gray'</span>, alpha<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="co"># plot3.fill_between((20, 80), 10, 60, facecolor= "red", alpha = 0.2)</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>conn1 <span class="op">=</span> ConnectionPatch(xyA <span class="op">=</span> (<span class="dv">20</span>, <span class="op">-</span><span class="fl">0.1</span>), coordsA<span class="op">=</span>plot1.transData,</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>                       xyB<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">0</span>), coordsB<span class="op">=</span>plot3.transData, color <span class="op">=</span> <span class="st">'black'</span>)</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>fig.add_artist(conn1)</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>conn2 <span class="op">=</span> ConnectionPatch(xyA <span class="op">=</span> (<span class="dv">79</span>, <span class="op">-</span><span class="fl">0.1</span>), coordsA<span class="op">=</span>plot1.transData,</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>                       xyB<span class="op">=</span>(<span class="dv">80</span>, <span class="dv">0</span>), coordsB<span class="op">=</span>plot3.transData, color <span class="op">=</span> <span class="st">'black'</span>)</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>fig.add_artist(conn2)</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-20-EbayesThresh toy ex_files/figure-html/cell-22-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="in-article" class="level1">
<h1>In article</h1>
<div id="1b53b4d7-619f-4db9-a996-90d7f84ad327" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> rpy2</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> rpy2.robjects <span class="im">as</span> ro </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rpy2.robjects.vectors <span class="im">import</span> FloatVector </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rpy2.robjects.packages <span class="im">import</span> importr</span></code></pre></div>
</div>
<div id="fc0ca42b-fed1-4a8f-af54-100747853054" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>load_ext rpy2.ipython</span></code></pre></div>
</div>
<div id="185144d8-e337-4805-954a-db8970ab6440" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>library(GNAR)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>library(igraph)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>R[write to console]: Loading required package: igraph

R[write to console]: 
Attaching package: ‘igraph’


R[write to console]: The following objects are masked from ‘package:stats’:

    decompose, spectrum


R[write to console]: The following object is masked from ‘package:base’:

    union


R[write to console]: Loading required package: wordcloud

R[write to console]: Loading required package: RColorBrewer
</code></pre>
</div>
</div>
<div id="e5c85ea1-2e38-45fb-82f6-7cd064889c96" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> rpy2</span></code></pre></div>
</div>
<div id="aa99c524-d7c2-47a5-9bd4-4e4b507c5483" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rpy2.robjects.packages <span class="im">import</span> importr</span></code></pre></div>
</div>
<div id="9be85460-900a-480a-b503-fbd5aafaac12" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>ebayesthresh <span class="op">=</span> importr(<span class="st">'EbayesThresh'</span>).ebayesthresh</span></code></pre></div>
</div>
<div id="165b6805-380d-4aef-8a09-fe477fe62900" class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#import rpy2</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co">#import rpy2.robjects as ro </span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rpy2.robjects.vectors <span class="im">import</span> FloatVector</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> rpy2.robjects <span class="im">as</span> robjects</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rpy2.robjects.packages <span class="im">import</span> importr</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> rpy2.robjects.numpy2ri <span class="im">as</span> rpyn</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>GNAR <span class="op">=</span> importr(<span class="st">'GNAR'</span>) <span class="co"># import GNAR </span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co">#igraph = importr('igraph') # import igraph </span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>ebayesthresh <span class="op">=</span> importr(<span class="st">'EbayesThresh'</span>).ebayesthresh</span></code></pre></div>
</div>
<div id="a53d8a07-5739-453e-bfe7-383660806304" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span>.seed(<span class="dv">1</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">&lt;-</span> rnorm(<span class="dv">1000</span>) <span class="op">+</span> sample(c( runif(<span class="dv">25</span>,<span class="op">-</span><span class="dv">7</span>,<span class="dv">7</span>), rep(<span class="dv">0</span>,<span class="dv">975</span>)))</span></code></pre></div>
</div>
<p><span class="math inline">\(X_i\)</span>에서 <span class="math inline">\(\mu_i\)</span> 추출 가능하는 것을 증명할 예제</p>
<div id="8a305e6d-3ae4-483a-bf56-28a6d253fa35" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>R</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># png("Ebayes_plot1.png", width=1600, height=800)</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>par(mfrow<span class="op">=</span>c(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>par(cex.axis<span class="op">=</span><span class="dv">2</span>) </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>par(cex.lab<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>plot(x, <span class="bu">type</span><span class="op">=</span><span class="st">'l'</span>, xlab<span class="op">=</span><span class="st">"Observed data"</span>, ylab<span class="op">=</span><span class="st">""</span>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>plot(ebayesthresh(x, sdev<span class="op">=</span><span class="dv">1</span>),<span class="bu">type</span><span class="op">=</span><span class="st">'l'</span>, xlab<span class="op">=</span><span class="st">"Estimate"</span>, ylab<span class="op">=</span><span class="st">""</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co"># dev.off()</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-20-EbayesThresh toy ex_files/figure-html/cell-31-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="3ef8793e-5c26-4dc4-91a3-126c94119a1f" class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> itstgcn</span></code></pre></div>
</div>
<div id="ca4f6674-9888-4b09-b08b-9938870af0c4" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>itstgcn.make_Psi(T)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<pre><code>array([[ 0.07106691, -0.10050378,  0.10050378, ..., -0.10050378,
        -0.10050378,  0.07106691],
       [ 0.10050378, -0.14206225,  0.14184765, ...,  0.14184765,
         0.14206225, -0.10050378],
       [ 0.10050378, -0.14184765,  0.14099032, ..., -0.14099032,
        -0.14184765,  0.10050378],
       ...,
       [ 0.10050378,  0.14184765,  0.14099032, ...,  0.14099032,
        -0.14184765, -0.10050378],
       [ 0.10050378,  0.14206225,  0.14184765, ..., -0.14184765,
         0.14206225,  0.10050378],
       [ 0.07106691,  0.10050378,  0.10050378, ...,  0.10050378,
        -0.10050378, -0.07106691]])</code></pre>
</div>
</div>
<div class="sourceCode" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> trim(f):</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    f <span class="op">=</span> np.array(f)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(f.shape)<span class="op">==</span><span class="dv">1</span>: f <span class="op">=</span> f.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    T,N <span class="op">=</span> f.shape</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    Psi <span class="op">=</span> make_Psi(T)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    fbar <span class="op">=</span> Psi.T <span class="op">@</span> f <span class="co"># apply dft </span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    fbar_threshed <span class="op">=</span> np.stack([ebayesthresh(FloatVector(fbar[:,i])) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N)],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    fhat <span class="op">=</span> Psi <span class="op">@</span> fbar_threshed <span class="co"># inverse dft </span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fhat</span></code></pre></div>
<div id="492851a8-eda9-4fb7-b27e-eb7609b4fe06" class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>plt.plot(y)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-20-EbayesThresh toy ex_files/figure-html/cell-34-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="604668af-cbf8-4726-ac52-9d0e71283d9c" class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>plt.plot(itstgcn.make_Psi(T).T<span class="op">@</span>y)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-20-EbayesThresh toy ex_files/figure-html/cell-35-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="f581a47e-fc77-453f-bf73-763545ea2319" class="cell" data-execution_count="178">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>plt.plot(ebayesthresh(FloatVector(itstgcn.make_Psi(T).T<span class="op">@</span>y)))</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-20-EbayesThresh toy ex_files/figure-html/cell-36-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="473277c8-1861-4a31-a473-9e554f61e39e" class="cell" data-execution_count="179">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>plt.plot(itstgcn.make_Psi(T)<span class="op">@</span>ebayesthresh(FloatVector(itstgcn.make_Psi(T).T<span class="op">@</span>y)))</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-20-EbayesThresh toy ex_files/figure-html/cell-37-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="06a46bbf-f4ed-4070-bc53-4e686e6d5f3c" class="cell" data-execution_count="358">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>_T <span class="op">=</span> <span class="dv">1000</span></span></code></pre></div>
</div>
<div id="4b0db51f-d298-4e95-a2ae-2c20a031db82" class="cell" data-execution_count="359">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>_t <span class="op">=</span> np.arange(_T)<span class="op">/</span>_T <span class="op">*</span> <span class="dv">10</span></span></code></pre></div>
</div>
<div id="c184a892-ae4c-44c8-ae65-25f1e76fa5d4" class="cell" data-execution_count="379">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>_x <span class="op">=</span> <span class="fl">1.5</span><span class="op">*</span>np.sin(<span class="dv">2</span><span class="op">*</span>_t)<span class="op">+</span><span class="dv">2</span><span class="op">*</span>np.random.rand(_T)<span class="op">+</span><span class="fl">1.5</span><span class="op">*</span>np.sin(<span class="dv">4</span><span class="op">*</span>_t)<span class="op">+</span><span class="fl">1.5</span><span class="op">*</span>np.sin(<span class="dv">8</span><span class="op">*</span>_t)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>plt.plot(_x)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-20-EbayesThresh toy ex_files/figure-html/cell-40-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="43148e67-8e62-4b0f-8a1f-36c663839f44" class="cell" data-execution_count="406">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> itstgcn</span></code></pre></div>
</div>
<div id="d0e69adf-c02d-4f1c-a7b0-a2bb337ccb9b" class="cell" data-execution_count="423">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Eval_csy:</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>,learner,train_dataset):</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.learner <span class="op">=</span> learner</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>        <span class="co"># self.learner.model.eval()</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:<span class="va">self</span>.learner.model.<span class="bu">eval</span>()</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:<span class="cf">pass</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.train_dataset <span class="op">=</span> train_dataset</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.lags <span class="op">=</span> <span class="va">self</span>.learner.lags</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>        rslt_tr <span class="op">=</span> <span class="va">self</span>.learner(<span class="va">self</span>.train_dataset) </span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.X_tr <span class="op">=</span> rslt_tr[<span class="st">'X'</span>]</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.y_tr <span class="op">=</span> rslt_tr[<span class="st">'y'</span>]</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.f_tr <span class="op">=</span> torch.concat([<span class="va">self</span>.train_dataset[<span class="dv">0</span>].x.T,<span class="va">self</span>.y_tr],axis<span class="op">=</span><span class="dv">0</span>).<span class="bu">float</span>()</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.yhat_tr <span class="op">=</span> rslt_tr[<span class="st">'yhat'</span>]</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fhat_tr <span class="op">=</span> torch.concat([<span class="va">self</span>.train_dataset[<span class="dv">0</span>].x.T,<span class="va">self</span>.yhat_tr],axis<span class="op">=</span><span class="dv">0</span>).<span class="bu">float</span>()</span></code></pre></div>
</div>
<div id="e2ced8ac-5392-41ea-bc31-24a1a8940ea1" class="cell" data-execution_count="415">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>_node_ids <span class="op">=</span> {<span class="st">'node1'</span>:<span class="dv">0</span>,<span class="st">'node2'</span>:<span class="dv">1</span>}</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>_FX1 <span class="op">=</span> np.stack([_x,_x],axis<span class="op">=</span><span class="dv">1</span>).tolist()</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>_edges1 <span class="op">=</span> torch.tensor([[<span class="dv">0</span>,<span class="dv">1</span>]]).tolist()</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>data_dict1 <span class="op">=</span> {<span class="st">'edges'</span>:_edges1, <span class="st">'node_ids'</span>:_node_ids, <span class="st">'FX'</span>:_FX1}</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>data1 <span class="op">=</span> pd.DataFrame({<span class="st">'x'</span>:_x,<span class="st">'x1'</span>:_x,<span class="st">'xer'</span>:_x,<span class="st">'xer1'</span>:_x})</span></code></pre></div>
</div>
<div id="6903d6d0-c06e-41b4-815b-494cbcec95b9" class="cell" data-execution_count="416">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>loader1 <span class="op">=</span> itstgcn.DatasetLoader(data_dict1)</span></code></pre></div>
</div>
<div id="1fc0ddeb-4e1c-4fed-b664-f1784dbd75e0" class="cell" data-execution_count="432">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>dataset <span class="op">=</span> loader1.get_dataset(lags<span class="op">=</span><span class="dv">2</span>)</span></code></pre></div>
</div>
<div id="7a9af815-6523-4991-aa05-afbd08d818ef" class="cell" data-execution_count="433">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>mindex <span class="op">=</span> itstgcn.rand_mindex(dataset,mrate<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>dataset_miss <span class="op">=</span> itstgcn.miss(dataset,mindex,mtype<span class="op">=</span><span class="st">'rand'</span>)</span></code></pre></div>
</div>
<div id="19903259-a878-4ed0-996b-a1ba32637de1" class="cell" data-execution_count="434">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>dataset_padded <span class="op">=</span> itstgcn.padding(dataset_miss,interpolation_method<span class="op">=</span><span class="st">'linear'</span>)</span></code></pre></div>
</div>
<div id="186156b5-aca1-4741-8da5-cd7648dac080" class="cell" data-execution_count="435">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>lrnr <span class="op">=</span> itstgcn.StgcnLearner(dataset_padded)</span></code></pre></div>
</div>
<div id="978c6163-463c-497e-8510-6b24a7bd463e" class="cell" data-execution_count="445">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>lrnr.learn(filters<span class="op">=</span><span class="dv">16</span>,epoch<span class="op">=</span><span class="dv">10</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>10/10</code></pre>
</div>
</div>
<div id="9a0c03b1-2c6f-4928-972b-e1790b4d9d2b" class="cell" data-execution_count="446">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>evtor <span class="op">=</span> Eval_csy(lrnr,dataset_padded)</span></code></pre></div>
</div>
<div id="ffb31905-2978-4d4b-a16d-fce13f209a6b" class="cell" data-execution_count="447">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>lrnr_2 <span class="op">=</span> itstgcn.ITStgcnLearner(dataset_padded)</span></code></pre></div>
</div>
<div id="5382a0bb-449a-413d-ad69-01c3ee8bf28a" class="cell" data-execution_count="448">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>lrnr_2.learn(filters<span class="op">=</span><span class="dv">16</span>,epoch<span class="op">=</span><span class="dv">10</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>10/10</code></pre>
</div>
</div>
<div id="4ce2b5c1-6210-4003-b55a-b38e4f5c6b8d" class="cell" data-execution_count="449">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>evtor_2 <span class="op">=</span> Eval_csy(lrnr_2,dataset_padded)</span></code></pre></div>
</div>
<p>Psi</p>
<div id="a6580d23-82fb-40d1-856a-82c9aa48d136" class="cell" data-execution_count="398">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> plt.style.context(<span class="st">'seaborn-white'</span>):</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    fig, ax1 <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">40</span>,<span class="dv">15</span>))</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    ax1.plot(_x,<span class="st">'k--'</span>,label<span class="op">=</span><span class="st">'Observed Data'</span>,lw<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    ax1.legend(fontsize<span class="op">=</span><span class="dv">40</span>,loc<span class="op">=</span><span class="st">'lower left'</span>,facecolor<span class="op">=</span><span class="st">'white'</span>, frameon<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    ax1.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, labelsize<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    ax1.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, labelsize<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>    ax1.set_ylim(<span class="op">-</span><span class="dv">6</span>,<span class="dv">6</span>)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'Ebayes_fst.pdf'</span>, <span class="bu">format</span><span class="op">=</span><span class="st">'pdf'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-20-EbayesThresh toy ex_files/figure-html/cell-57-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>fourier transform</p>
<div id="87fc3a5c-29c4-4b99-a240-5f5172319e7d" class="cell" data-execution_count="399">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> plt.style.context(<span class="st">'seaborn-white'</span>):</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>    fig, ax1 <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">40</span>,<span class="dv">15</span>))</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ax1.plot(itstgcn.make_Psi(_T).T@np.array(_x),'-',color='C1',label='Fourier Transform',lw=3)</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    ax1.stem(itstgcn.make_Psi(_T).T<span class="op">@</span>np.array(_x),linefmt<span class="op">=</span><span class="st">'C1-'</span>,basefmt<span class="op">=</span><span class="st">'k-'</span>,label<span class="op">=</span><span class="st">'Fourier Transform'</span>)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>    ax1.legend(fontsize<span class="op">=</span><span class="dv">40</span>,loc<span class="op">=</span><span class="st">'upper right'</span>,facecolor<span class="op">=</span><span class="st">'white'</span>, frameon<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>    ax1.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, labelsize<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    ax1.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, labelsize<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'Ebayes_snd.pdf'</span>, <span class="bu">format</span><span class="op">=</span><span class="st">'pdf'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-20-EbayesThresh toy ex_files/figure-html/cell-58-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="0b445086-900e-4b51-beff-32dfd67ee589" class="cell" data-execution_count="400">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> plt.style.context(<span class="st">'seaborn-white'</span>):</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>    fig, ax1 <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">40</span>,<span class="dv">15</span>))</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ax1.plot(itstgcn.make_Psi(_T).T@np.array(_x),'-',color='C1',label='Fourier Transform',lw=3)</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>    ax1.stem((itstgcn.make_Psi(_T).T<span class="op">@</span>np.array(_x))[:<span class="dv">100</span>],linefmt<span class="op">=</span><span class="st">'C1-'</span>,basefmt<span class="op">=</span><span class="st">'k-'</span>,label<span class="op">=</span><span class="st">'Fourier Transform'</span>)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>    ax1.legend(fontsize<span class="op">=</span><span class="dv">40</span>,loc<span class="op">=</span><span class="st">'upper right'</span>,facecolor<span class="op">=</span><span class="st">'white'</span>, frameon<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>    ax1.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, labelsize<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>    ax1.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, labelsize<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'Ebayes_snd_zin.pdf'</span>, <span class="bu">format</span><span class="op">=</span><span class="st">'pdf'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-20-EbayesThresh toy ex_files/figure-html/cell-59-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Ebayesthresh/trim</p>
<div id="bc1e34f2-4a12-4a2b-aed0-b7b566423ac0" class="cell" data-execution_count="404">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> plt.style.context(<span class="st">'seaborn-white'</span>):</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>    fig, ax1 <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">40</span>,<span class="dv">15</span>))</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ax1.plot(ebayesthresh(FloatVector(itstgcn.make_Psi(_T).T@np.array(_x))),'-',color='C1',label='EbayesThresh',lw=3)</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    ax1.stem(ebayesthresh(FloatVector(itstgcn.make_Psi(_T).T<span class="op">@</span>np.array(_x))),linefmt<span class="op">=</span><span class="st">'C1-'</span>,basefmt<span class="op">=</span><span class="st">'k-'</span>,label<span class="op">=</span><span class="st">'EbayesThresh'</span>)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    ax1.legend(fontsize<span class="op">=</span><span class="dv">40</span>,loc<span class="op">=</span><span class="st">'upper right'</span>,facecolor<span class="op">=</span><span class="st">'white'</span>, frameon<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    ax1.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, labelsize<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>    ax1.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, labelsize<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'Ebayes_trd.pdf'</span>, <span class="bu">format</span><span class="op">=</span><span class="st">'pdf'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-20-EbayesThresh toy ex_files/figure-html/cell-60-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="704c38e7-3937-4255-9c1e-c6bbcb316ca5" class="cell" data-execution_count="402">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> plt.style.context(<span class="st">'seaborn-white'</span>):</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>    fig, ax1 <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">40</span>,<span class="dv">15</span>))</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ax1.plot(ebayesthresh(FloatVector(itstgcn.make_Psi(_T).T@np.array(_x))),'-',color='C1',label='EbayesThresh',lw=3)</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>    ax1.stem((ebayesthresh(FloatVector(itstgcn.make_Psi(_T).T<span class="op">@</span>np.array(_x))))[:<span class="dv">100</span>],linefmt<span class="op">=</span><span class="st">'C1-'</span>,basefmt<span class="op">=</span><span class="st">'k-'</span>,label<span class="op">=</span><span class="st">'EbayesThresh'</span>)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>    ax1.legend(fontsize<span class="op">=</span><span class="dv">40</span>,loc<span class="op">=</span><span class="st">'upper right'</span>,facecolor<span class="op">=</span><span class="st">'white'</span>, frameon<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>    ax1.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, labelsize<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>    ax1.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, labelsize<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'Ebayes_trd_zout.pdf'</span>, <span class="bu">format</span><span class="op">=</span><span class="st">'pdf'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-20-EbayesThresh toy ex_files/figure-html/cell-61-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>fhat</p>
<div id="16772131-d33e-4bb4-a9e0-3961b5c549d1" class="cell" data-execution_count="403">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> plt.style.context(<span class="st">'seaborn-white'</span>):</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>    fig, ax1 <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">40</span>,<span class="dv">15</span>))</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>    ax1.plot(_x,<span class="st">'k--'</span>,label<span class="op">=</span><span class="st">'Observed Data'</span>,lw<span class="op">=</span><span class="dv">3</span>,alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>    ax1.plot(itstgcn.make_Psi(_T)<span class="op">@</span>ebayesthresh(FloatVector(itstgcn.make_Psi(_T).T<span class="op">@</span>np.array(_x))),<span class="st">'-'</span>,color<span class="op">=</span><span class="st">'C1'</span>,label<span class="op">=</span><span class="st">'Inverse Fourier Transform'</span>,lw<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>    ax1.legend(fontsize<span class="op">=</span><span class="dv">40</span>,loc<span class="op">=</span><span class="st">'lower left'</span>,facecolor<span class="op">=</span><span class="st">'white'</span>, frameon<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>    ax1.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, labelsize<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>    ax1.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, labelsize<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>    ax1.set_ylim(<span class="op">-</span><span class="dv">6</span>,<span class="dv">6</span>)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="st">'Ebayes_fth.pdf'</span>, <span class="bu">format</span><span class="op">=</span><span class="st">'pdf'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-20-EbayesThresh toy ex_files/figure-html/cell-62-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="ce21bdb5-1f00-4e3f-ba3c-e543ad3b5f18" class="cell" data-execution_count="450">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> plt.style.context(<span class="st">'seaborn-white'</span>):</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>    fig, ax1 <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">40</span>,<span class="dv">15</span>))</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fig.suptitle('Figure 1(node 1)',fontsize=40)</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>    ax1.plot(data1[<span class="st">'x'</span>][:],<span class="st">'-'</span>,color<span class="op">=</span><span class="st">'C3'</span>,label<span class="op">=</span><span class="st">'Complete Data'</span>)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>    ax1.legend(fontsize<span class="op">=</span><span class="dv">40</span>,loc<span class="op">=</span><span class="st">'lower left'</span>,facecolor<span class="op">=</span><span class="st">'white'</span>, frameon<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>    ax1.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, labelsize<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>    ax1.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, labelsize<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.savefig('node1_fst.png')</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-20-EbayesThresh toy ex_files/figure-html/cell-63-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="f39e4382-99f1-4436-9d90-c3975965c726" class="cell" data-execution_count="451">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> plt.style.context(<span class="st">'seaborn-white'</span>):</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>    fig, ax2 <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">40</span>,<span class="dv">15</span>))</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fig.suptitle('Figure 1(node 1)',fontsize=40)</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>    ax2.plot(data1[<span class="st">'x'</span>][:],<span class="st">'--'</span>,color<span class="op">=</span><span class="st">'C5'</span>,alpha<span class="op">=</span><span class="fl">0.5</span>,label<span class="op">=</span><span class="st">'Complete Data'</span>)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>    ax2.plot(torch.cat([torch.tensor(data1[<span class="st">'x'</span>][:<span class="dv">4</span>]),torch.tensor(dataset_miss.targets).reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">2</span>)[:,<span class="dv">0</span>]],dim<span class="op">=</span><span class="dv">0</span>),<span class="st">'--o'</span>,color<span class="op">=</span><span class="st">'C3'</span>,label<span class="op">=</span><span class="st">'Observed Data'</span>,markersize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>    ax2.legend(fontsize<span class="op">=</span><span class="dv">40</span>,loc<span class="op">=</span><span class="st">'lower left'</span>,facecolor<span class="op">=</span><span class="st">'white'</span>, frameon<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>    ax2.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, labelsize<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>    ax2.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, labelsize<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.savefig('node1_snd.png')</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-20-EbayesThresh toy ex_files/figure-html/cell-64-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="d9e22949-8e00-4287-a79c-f0d4c2ce48b1" class="cell" data-execution_count="452">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> plt.style.context(<span class="st">'seaborn-white'</span>):</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>    fig, ax3 <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">40</span>,<span class="dv">15</span>))</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fig.suptitle('Figure 1(node 1)',fontsize=40)    </span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>    ax3.plot(data1[<span class="st">'x'</span>][:],<span class="st">'--'</span>,color<span class="op">=</span><span class="st">'C5'</span>,alpha<span class="op">=</span><span class="fl">0.5</span>,label<span class="op">=</span><span class="st">'Complete Data'</span>)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>    ax3.plot(evtor_2.f_tr[:,<span class="dv">0</span>],<span class="st">'--o'</span>,color<span class="op">=</span><span class="st">'C3'</span>,alpha<span class="op">=</span><span class="fl">0.8</span>,label<span class="op">=</span><span class="st">'Interpolarion'</span>)</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>    ax3.legend(fontsize<span class="op">=</span><span class="dv">40</span>,loc<span class="op">=</span><span class="st">'lower left'</span>,facecolor<span class="op">=</span><span class="st">'white'</span>, frameon<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>    ax3.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, labelsize<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>    ax3.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, labelsize<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.savefig('node1_3rd.png')</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-20-EbayesThresh toy ex_files/figure-html/cell-65-output-1.png" class="img-fluid"></p>
</div>
</div>
<div id="09bcea8f-fda2-4462-a18f-63800efba2df" class="cell" data-execution_count="453">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> plt.style.context(<span class="st">'seaborn-white'</span>):</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>    fig, ax4 <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">40</span>,<span class="dv">15</span>))</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fig.suptitle('Figure 1(node 1)',fontsize=40)</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    ax4.plot(data1[<span class="st">'x'</span>][:],<span class="st">'--'</span>,color<span class="op">=</span><span class="st">'C5'</span>,alpha<span class="op">=</span><span class="fl">0.5</span>,label<span class="op">=</span><span class="st">'Complete Data'</span>)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>    ax4.plot(evtor.fhat_tr[:,<span class="dv">0</span>],color<span class="op">=</span><span class="st">'brown'</span>,lw<span class="op">=</span><span class="dv">3</span>,label<span class="op">=</span><span class="st">'STGCN'</span>)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>    ax4.plot(evtor_2.fhat_tr[:,<span class="dv">0</span>],color<span class="op">=</span><span class="st">'blue'</span>,lw<span class="op">=</span><span class="dv">3</span>,label<span class="op">=</span><span class="st">'ITSTGCN'</span>)</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ax4.plot(138, -1.2, 'o', markersize=230, markerfacecolor='none', markeredgecolor='red',markeredgewidth=3)</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ax4.plot(220, -1.5, 'o', markersize=200, markerfacecolor='none', markeredgecolor='red',markeredgewidth=3)</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ax4.plot(290, -1.2, 'o', markersize=310, markerfacecolor='none', markeredgecolor='red',markeredgewidth=3)</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ax4.plot(455, -0.9, 'o', markersize=280, markerfacecolor='none', markeredgecolor='red',markeredgewidth=3)</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>    ax4.legend(fontsize<span class="op">=</span><span class="dv">40</span>,loc<span class="op">=</span><span class="st">'lower left'</span>,facecolor<span class="op">=</span><span class="st">'white'</span>, frameon<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>    ax4.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, labelsize<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>    ax4.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, labelsize<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.savefig('node1_4th_1.png')</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2023-05-20-EbayesThresh toy ex_files/figure-html/cell-66-output-1.png" class="img-fluid"></p>
</div>
</div>



</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        console.log("RESIZE");
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="seoyeonc/sy_hub" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->




</body></html>